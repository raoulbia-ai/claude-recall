{"file":"/mnt/c/Users/ebiarao/repos/claude-recall/src/services/preference-extractor.ts","mappings":"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","names":[],"sources":["/mnt/c/Users/ebiarao/repos/claude-recall/src/services/preference-extractor.ts"],"sourcesContent":["import { LoggingService } from './logging';\n\nexport interface ExtractedPreference {\n  key: string;           // e.g., \"test_location\", \"code_style\"\n  value: string | { category: string; value: string; raw: string; };         // e.g., \"tests-arlo\", \"4_spaces\", or devops object\n  confidence: number;    // 0.0-1.0 confidence score\n  raw: string;           // Original text\n  isOverride: boolean;   // True if this updates existing preference\n  overrideSignals: string[]; // e.g., [\"moving forward\", \"actually\"]\n}\n\nexport class PreferenceExtractor {\n  private logger = LoggingService.getInstance();\n  \n  private readonly OVERRIDE_SIGNALS = {\n    temporal: [\"moving forward\", \"from now on\", \"going forward\", \"henceforth\"],\n    change: [\"actually\", \"instead\", \"rather than\", \"changed my mind\"],\n    update: [\"update to\", \"replace with\", \"switch to\", \"migrate to\"],\n    revert: [\"go back to\", \"return to\", \"revert to\", \"back to using\"]\n  };\n\n  private readonly PREFERENCE_PATTERNS = {\n    test_location: {\n      triggers: [\"test\", \"tests\", \"test files\", \"testing\", \"spec\", \"specs\"],\n      locationWords: [\"in\", \"to\", \"at\", \"under\", \"within\", \"inside\"],\n      valuePattern: /(?:in|to|at|under|within|inside)\\s+([\\w\\-\\/\\.]+)/i\n    },\n    code_style: {\n      triggers: [\"spaces\", \"tabs\", \"indentation\", \"indent\", \"formatting\", \"style\"],\n      patterns: [\n        { pattern: /(\\d+)\\s*spaces?/i, extract: (m: RegExpMatchArray) => `${m[1]}_spaces` },\n        { pattern: /tabs?/i, extract: () => \"tabs\" },\n        { pattern: /semicolons?/i, extract: () => \"semicolons\" },\n        { pattern: /no\\s*semicolons?/i, extract: () => \"no_semicolons\" },\n        { pattern: /single\\s*quotes?/i, extract: () => \"single_quotes\" },\n        { pattern: /double\\s*quotes?/i, extract: () => \"double_quotes\" }\n      ]\n    },\n    framework_choice: {\n      triggers: [\"use\", \"prefer\", \"framework\", \"library\", \"package\"],\n      frameworks: {\n        http_client: [\"axios\", \"fetch\", \"superagent\", \"got\"],\n        test_framework: [\"jest\", \"vitest\", \"mocha\", \"jasmine\", \"cypress\"],\n        build_tool: [\"webpack\", \"vite\", \"rollup\", \"parcel\"],\n        ui_framework: [\"react\", \"vue\", \"angular\", \"svelte\"]\n      }\n    },\n    file_organization: {\n      triggers: [\"save\", \"store\", \"put\", \"place\", \"create\", \"organize\"],\n      types: [\"config\", \"configs\", \"configuration\", \"assets\", \"images\", \"styles\", \"components\"]\n    },\n    project_info: {\n      // Generic key-value patterns for project information (IDs, endpoints, URLs, etc.)\n      // Broad triggers - these are words commonly used when providing project details\n      triggers: [\"id\", \"endpoint\", \"api\", \"url\", \"configured\", \"our\", \"using\", \"is\", \":\", \"have\"],\n      patterns: [\n        // Pattern: \"X ID is Y\" or \"X ID: Y\"\n        { pattern: /([\\w\\s]+)\\s*(?:ID|id)\\s*(?:is|:)\\s*([^\\s,;]+)/i, keyIndex: 1, valueIndex: 2 },\n        // Pattern: \"X endpoint is Y\" or \"X endpoint: Y\"\n        { pattern: /([\\w\\s]+)\\s*(?:endpoint|api)\\s*(?:is|:)\\s*([^\\s,;]+)/i, keyIndex: 1, valueIndex: 2 },\n        // Pattern: \"X URL is Y\" or \"X URL: Y\"\n        { pattern: /([\\w\\s]+)\\s*(?:URL|url)\\s*(?:is|:)\\s*([^\\s,;]+)/i, keyIndex: 1, valueIndex: 2 },\n        // Pattern: \"configured to X\" or \"configured as X\"\n        { pattern: /configured\\s+(?:to|as)\\s+([^\\s,;.]+)/i, keyIndex: 0, valueIndex: 1, keyDefault: \"configuration\" },\n        // Pattern: \"our X is Y\"\n        { pattern: /our\\s+([\\w\\s]+)\\s+(?:is|:)\\s+([^\\s,;]+)/i, keyIndex: 1, valueIndex: 2 },\n        // Pattern: \"we're using X for Y\" or \"we use X\"\n        { pattern: /we(?:'re| are)?\\s+using\\s+([^\\s,;.]+)/i, keyIndex: 0, valueIndex: 1, keyDefault: \"tool\" },\n        // Pattern: \"X: Y\" (generic key-value)\n        { pattern: /([\\w\\s]{3,20}):\\s*([^\\s,;]+)/i, keyIndex: 1, valueIndex: 2 }\n      ]\n    },\n    devops: {\n      // DevOps workflows, development practices, git conventions, testing approaches\n      // All patterns are generic and work across any project domain\n      triggers: [\n        \"this is\", \"built with\", \"uses\", \"requires\", \"depends on\",\n        \"develop on\", \"test on\", \"deploy\", \"workflow\", \"always\", \"must\", \"never\",\n        \"architecture\", \"approach\", \"strategy\", \"git\", \"commit\", \"branch\",\n        \"tdd\", \"testing\", \"build\", \"environment\"\n      ],\n      patterns: [\n        // Project identity patterns\n        { pattern: /this\\s+(?:is|will be)\\s+(?:a|an)\\s+(.+?)(?:\\.|$)/i, category: \"project_purpose\" },\n        { pattern: /(?:building|creating)\\s+(?:a|an)\\s+(.+?)(?:\\.|$)/i, category: \"project_purpose\" },\n\n        // Tech stack patterns\n        { pattern: /built\\s+with\\s+(.+?)(?:\\.|,|and|$)/i, category: \"tech_stack\" },\n        { pattern: /uses?\\s+([\\w\\s+]+?)\\s+(?:for|as|to)/i, category: \"tech_stack\" },\n        { pattern: /(?:frontend|backend|database|framework).*?(?:is|uses?)\\s+(.+?)(?:\\.|,|$)/i, category: \"tech_stack\" },\n\n        // Dev environment patterns\n        { pattern: /(?:develop|code|work)\\s+(?:on|in|with)\\s+(.+?)(?:\\.|,|for|$)/i, category: \"dev_environment\" },\n        { pattern: /use\\s+(WSL|Windows|Linux|Mac|macOS|Docker).*?for\\s+(.+?)(?:\\.|,|$)/i, category: \"dev_environment\" },\n\n        // Workflow rule patterns\n        { pattern: /always\\s+(.+?)\\s+before\\s+(.+?)(?:\\.|$)/i, category: \"workflow_rule\" },\n        { pattern: /must\\s+(.+?)(?:\\.|,|before|after)/i, category: \"workflow_rule\" },\n        { pattern: /never\\s+(.+?)(?:\\.|,|$)/i, category: \"workflow_rule\" },\n\n        // Git workflow patterns\n        { pattern: /(?:create|use|make)\\s+.*?branch.*?(?:from|for)\\s+(.+?)(?:\\.|$)/i, category: \"git_workflow\" },\n        { pattern: /commit.*?(?:format|style|convention).*?(?:is|uses?)\\s+(.+?)(?:\\.|$)/i, category: \"git_workflow\" },\n        { pattern: /(?:merge|squash|rebase).*?(?:before|after|into)\\s+(.+?)(?:\\.|$)/i, category: \"git_workflow\" },\n\n        // Testing approach patterns\n        { pattern: /(?:use|follow|practice)\\s+(TDD|test[- ]driven|BDD|behavior[- ]driven)/i, category: \"testing_approach\" },\n        { pattern: /tests?\\s+(?:go|belong|are|live)\\s+in\\s+(.+?)(?:\\.|$)/i, category: \"testing_approach\" },\n        { pattern: /(?:write|run)\\s+tests?\\s+(?:before|after|for)\\s+(.+?)(?:\\.|$)/i, category: \"testing_approach\" },\n\n        // Architecture patterns\n        { pattern: /(?:uses?|follows?)\\s+(.+?)\\s+(?:architecture|pattern|design)(?:\\.|$)/i, category: \"architecture\" },\n        { pattern: /(?:microservices?|monolith|serverless|event[- ]driven)/i, category: \"architecture\" },\n\n        // Dependency patterns\n        { pattern: /requires?\\s+(.+?)(?:\\.|,|for)/i, category: \"dependency\" },\n        { pattern: /depends?\\s+on\\s+(.+?)(?:\\.|$)/i, category: \"dependency\" },\n\n        // Build/deploy patterns\n        { pattern: /(?:build|deploy|run)\\s+(?:with|using)\\s+(.+?)(?:\\.|$)/i, category: \"build_deploy\" },\n        { pattern: /(?:docker|container|kubernetes|k8s)/i, category: \"build_deploy\" }\n      ]\n    }\n  };\n\n  /**\n   * Extract preferences from natural language text\n   */\n  extractPreferences(prompt: string): ExtractedPreference[] {\n    try {\n      const sentences = this.splitIntoSentences(prompt);\n      const preferences: ExtractedPreference[] = [];\n\n      for (const sentence of sentences) {\n        if (this.indicatesPreference(sentence)) {\n          const preference = this.extractPreferenceFromSentence(sentence);\n          if (preference && preference.confidence >= 0.5) { // Lowered threshold for broader capture\n            preferences.push(preference);\n            \n            this.logger.debug('PreferenceExtractor', `Extracted preference: ${preference.key} = ${preference.value}`, {\n              confidence: preference.confidence,\n              isOverride: preference.isOverride,\n              raw: preference.raw\n            });\n          }\n        }\n      }\n\n      return preferences;\n    } catch (error) {\n      this.logger.logServiceError('PreferenceExtractor', 'extractPreferences', error as Error);\n      return [];\n    }\n  }\n\n  /**\n   * Check if sentence indicates a preference\n   */\n  private indicatesPreference(sentence: string): boolean {\n    const lower = sentence.toLowerCase();\n    \n    // Check for preference indicators\n    const preferenceIndicators = [\n      \"prefer\", \"use\", \"save\", \"store\", \"put\", \"place\", \"create\", \"make\",\n      \"should\", \"want\", \"like\", \"love\", \"always\", \"never\", \"from now on\",\n      \"moving forward\", \"going forward\", \"henceforth\",\n      // Team/project context\n      \"our\", \"we're using\", \"we have\", \"we use\", \"configured\", \"set up\",\n      \"using\", \"enabled\", \"installed\", \"established\"\n    ];\n    \n    return preferenceIndicators.some(indicator => lower.includes(indicator));\n  }\n\n  /**\n   * Extract preference from a single sentence\n   */\n  private extractPreferenceFromSentence(sentence: string): ExtractedPreference | null {\n    const lower = sentence.toLowerCase();\n    \n    // Try each preference pattern\n    for (const [key, pattern] of Object.entries(this.PREFERENCE_PATTERNS)) {\n      const preference = this.extractSpecificPreference(sentence, key, pattern);\n      if (preference) {\n        return preference;\n      }\n    }\n    \n    return null;\n  }\n\n  /**\n   * Extract specific preference type from sentence\n   */\n  private extractSpecificPreference(sentence: string, key: string, pattern: any): ExtractedPreference | null {\n    const lower = sentence.toLowerCase();\n    \n    // Check if sentence contains triggers for this preference type\n    const hasTrigger = pattern.triggers.some((trigger: string) => lower.includes(trigger));\n    if (!hasTrigger) return null;\n    \n    let value: string | null = null;\n    let confidence = 0.7; // Base confidence\n    \n    switch (key) {\n      case 'test_location':\n        value = this.extractTestLocation(sentence, pattern);\n        break;\n      case 'code_style':\n        value = this.extractCodeStyle(sentence, pattern);\n        break;\n      case 'framework_choice':\n        value = this.extractFrameworkChoice(sentence, pattern);\n        break;\n      case 'file_organization':\n        value = this.extractFileOrganization(sentence, pattern);\n        break;\n      case 'project_info':\n        return this.extractProjectInfo(sentence, pattern);\n      case 'devops':\n        return this.extractDevOps(sentence, pattern);\n    }\n    \n    if (!value) return null;\n    \n    // Detect override intent\n    const overrideSignals = this.detectOverrideSignals(sentence);\n    const isOverride = overrideSignals.length > 0;\n    \n    // Boost confidence for explicit preferences\n    if (lower.includes(\"prefer\") || lower.includes(\"always\") || lower.includes(\"never\")) {\n      confidence += 0.2;\n    }\n    \n    // Boost confidence for override signals\n    if (isOverride) {\n      confidence += 0.1;\n    }\n    \n    // Boost confidence for specific patterns\n    if (lower.includes(\"from now on\") || lower.includes(\"moving forward\")) {\n      confidence += 0.15;\n    }\n    \n    return {\n      key: this.getPreferenceKey(key, value, sentence),\n      value,\n      confidence: Math.min(confidence, 1.0),\n      raw: sentence.trim(),\n      isOverride,\n      overrideSignals\n    };\n  }\n\n  /**\n   * Extract test location from sentence\n   */\n  private extractTestLocation(sentence: string, pattern: any): string | null {\n    const match = sentence.match(pattern.valuePattern);\n    if (match && match[1]) {\n      return match[1].trim();\n    }\n    \n    // Fallback: look for directory-like words after location words\n    const words = sentence.split(/\\s+/);\n    for (let i = 0; i < words.length - 1; i++) {\n      if (pattern.locationWords.some((locWord: string) => words[i].toLowerCase() === locWord)) {\n        const nextWord = words[i + 1];\n        if (nextWord && /^[\\w\\-\\/\\.]+$/.test(nextWord)) {\n          return nextWord;\n        }\n      }\n    }\n    \n    return null;\n  }\n\n  /**\n   * Extract code style preferences\n   */\n  private extractCodeStyle(sentence: string, pattern: any): string | null {\n    for (const stylePattern of pattern.patterns) {\n      const match = sentence.match(stylePattern.pattern);\n      if (match) {\n        return stylePattern.extract(match);\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Extract framework choice preferences\n   */\n  private extractFrameworkChoice(sentence: string, pattern: any): string | null {\n    const lower = sentence.toLowerCase();\n    \n    for (const [category, frameworks] of Object.entries(pattern.frameworks)) {\n      for (const framework of frameworks as string[]) {\n        if (lower.includes(framework)) {\n          return framework;\n        }\n      }\n    }\n    \n    return null;\n  }\n\n  /**\n   * Extract file organization preferences\n   */\n  private extractFileOrganization(sentence: string, pattern: any): string | null {\n    const lower = sentence.toLowerCase();\n\n    // Look for file type + location pattern\n    for (const type of pattern.types) {\n      if (lower.includes(type)) {\n        const locationMatch = sentence.match(new RegExp(`${type}.*?(?:in|to|at|under)\\\\s+([\\\\w\\\\-\\\\/\\\\.]+)`, 'i'));\n        if (locationMatch && locationMatch[1]) {\n          return `${type}:${locationMatch[1]}`;\n        }\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Extract generic project information (IDs, endpoints, URLs, configurations)\n   */\n  private extractProjectInfo(sentence: string, pattern: any): ExtractedPreference | null {\n    // Try each pattern\n    for (const infoPattern of pattern.patterns) {\n      const match = sentence.match(infoPattern.pattern);\n      if (match) {\n        let key: string;\n        let value: string;\n\n        // Extract key based on pattern configuration\n        if (infoPattern.keyIndex > 0 && match[infoPattern.keyIndex]) {\n          key = match[infoPattern.keyIndex].trim().toLowerCase().replace(/\\s+/g, '_');\n        } else if (infoPattern.keyDefault) {\n          key = infoPattern.keyDefault;\n        } else {\n          continue; // Skip if no key found\n        }\n\n        // Extract value\n        if (match[infoPattern.valueIndex]) {\n          value = match[infoPattern.valueIndex].trim();\n        } else {\n          continue; // Skip if no value found\n        }\n\n        // Detect override intent\n        const overrideSignals = this.detectOverrideSignals(sentence);\n        const isOverride = overrideSignals.length > 0;\n\n        // Set confidence based on pattern specificity\n        let confidence = 0.6; // Base confidence for project info\n\n        // Boost confidence for explicit patterns (ID, endpoint, URL)\n        const lower = sentence.toLowerCase();\n        if (lower.includes(' id') || lower.includes('endpoint') || lower.includes('url')) {\n          confidence += 0.15;\n        }\n\n        // Boost confidence for team context (\"our\", \"we\")\n        if (lower.includes('our ') || lower.includes('we')) {\n          confidence += 0.1;\n        }\n\n        // Boost confidence for override signals\n        if (isOverride) {\n          confidence += 0.1;\n        }\n\n        return {\n          key,\n          value,\n          confidence: Math.min(confidence, 1.0),\n          raw: sentence.trim(),\n          isOverride,\n          overrideSignals\n        };\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Extract DevOps workflow patterns (git, testing, build, environment)\n   */\n  private extractDevOps(sentence: string, pattern: any): ExtractedPreference | null {\n    const lower = sentence.toLowerCase();\n\n    // Try each devops pattern\n    for (const devopsPattern of pattern.patterns) {\n      const match = sentence.match(devopsPattern.pattern);\n      if (match) {\n        // Extract matched content\n        const matchedText = match[0];\n        const category = devopsPattern.category;\n\n        // Determine key based on category\n        let key = category;\n        let value = matchedText.trim();\n\n        // Extract more specific value if captured group exists\n        if (match[1]) {\n          value = match[1].trim();\n        }\n\n        // Detect override intent\n        const overrideSignals = this.detectOverrideSignals(sentence);\n        const isOverride = overrideSignals.length > 0;\n\n        // Set confidence based on pattern type and keywords\n        let confidence = 0.7; // Base confidence for devops\n\n        // Boost confidence for strong keywords\n        if (lower.includes('always') || lower.includes('never') || lower.includes('must')) {\n          confidence += 0.2;\n        }\n\n        // Boost confidence for specific categories\n        if (category === 'workflow_rule' || category === 'git_workflow') {\n          confidence += 0.1;\n        }\n\n        // Boost confidence for explicit practices\n        if (lower.includes('tdd') || lower.includes('test-driven') || lower.includes('ci/cd')) {\n          confidence += 0.15;\n        }\n\n        // Boost confidence for team context\n        if (lower.includes('our ') || lower.includes('we ') || lower.includes('team')) {\n          confidence += 0.1;\n        }\n\n        // Boost confidence for override signals\n        if (isOverride) {\n          confidence += 0.1;\n        }\n\n        return {\n          key: `devops_${category}`,\n          value: {\n            category,\n            value,\n            raw: matchedText\n          },\n          confidence: Math.min(confidence, 1.0),\n          raw: sentence.trim(),\n          isOverride,\n          overrideSignals\n        };\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Get the appropriate preference key based on the detected pattern\n   */\n  private getPreferenceKey(key: string, value: string, sentence: string): string {\n    if (key === 'framework_choice') {\n      return this.getFrameworkKey(value);\n    } else if (key === 'code_style') {\n      // Map code_style to more specific keys\n      const lower = sentence.toLowerCase();\n      if (lower.includes('indent') || lower.includes('spaces') || lower.includes('tabs')) {\n        return 'indentation';\n      } else if (lower.includes('quote')) {\n        return 'quotes';\n      } else if (lower.includes('semicolon')) {\n        return 'semicolons';\n      }\n    }\n    \n    return key;\n  }\n\n  /**\n   * Get the appropriate framework key based on detected framework\n   */\n  private getFrameworkKey(framework: string): string {\n    const frameworkMappings: Record<string, string> = {\n      'axios': 'http_client',\n      'fetch': 'http_client',\n      'superagent': 'http_client',\n      'got': 'http_client',\n      'jest': 'test_framework',\n      'vitest': 'test_framework',\n      'mocha': 'test_framework',\n      'jasmine': 'test_framework',\n      'cypress': 'test_framework',\n      'webpack': 'build_tool',\n      'vite': 'build_tool',\n      'rollup': 'build_tool',\n      'parcel': 'build_tool',\n      'react': 'ui_framework',\n      'vue': 'ui_framework',\n      'angular': 'ui_framework',\n      'svelte': 'ui_framework'\n    };\n    \n    return frameworkMappings[framework] || 'framework_choice';\n  }\n\n  /**\n   * Detect override signals in sentence\n   */\n  private detectOverrideSignals(sentence: string): string[] {\n    const lower = sentence.toLowerCase();\n    const signals: string[] = [];\n    \n    for (const [category, signalList] of Object.entries(this.OVERRIDE_SIGNALS)) {\n      for (const signal of signalList) {\n        if (lower.includes(signal.toLowerCase())) {\n          signals.push(signal);\n        }\n      }\n    }\n    \n    return signals;\n  }\n\n  /**\n   * Split text into sentences for processing\n   */\n  private splitIntoSentences(text: string): string[] {\n    // Enhanced sentence splitting that handles common patterns\n    return text.split(/[.!?]+|(?:\\n\\s*\\n)/)\n               .map(s => s.trim())\n               .filter(s => s.length > 10) // Filter out very short fragments\n               .map(s => s.replace(/\\s+/g, ' ')); // Normalize whitespace\n  }\n}"],"version":3}