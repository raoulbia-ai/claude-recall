{"file":"/mnt/c/Users/ebiarao/repos/claude-recall/tests/unit/patterns.test.ts","mappings":"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","names":[],"sources":["/mnt/c/Users/ebiarao/repos/claude-recall/tests/unit/patterns.test.ts"],"sourcesContent":["import { PatternDetector, CorrectionPattern } from '../../src/core/patterns';\nimport { PatternStore } from '../../src/memory/pattern-store';\nimport { MemoryStorage } from '../../src/memory/storage';\n\ndescribe('PatternDetector', () => {\n  let detector: PatternDetector;\n  \n  beforeEach(() => {\n    detector = new PatternDetector();\n  });\n  \n  it('should detect corrections', () => {\n    const pattern = detector.detectCorrection(\n      'function getUserData() {}',\n      'function fetchUserData() {}'\n    );\n    \n    expect(pattern).toBeDefined();\n    expect(pattern?.original).toContain('function IDENTIFIER');\n    expect(pattern?.corrected).toContain('function IDENTIFIER');\n    expect(pattern?.context).toBe('function-declaration');\n    expect(pattern?.frequency).toBe(1);\n  });\n  \n  it('should return null for identical strings', () => {\n    const pattern = detector.detectCorrection(\n      'const data = 5;',\n      'const data = 5;'\n    );\n    \n    expect(pattern).toBeNull();\n  });\n  \n  it('should generalize patterns', () => {\n    const pattern = detector.detectCorrection(\n      'var userName = \"John\"',\n      'const userName = \"John\"'\n    );\n    \n    expect(pattern?.original).toBe('var IDENTIFIER = STRING');\n    expect(pattern?.corrected).toBe('const IDENTIFIER = STRING');\n    expect(pattern?.context).toBe('variable-declaration');\n  });\n  \n  it('should detect function call patterns', () => {\n    const pattern = detector.detectCorrection(\n      'checkAuth(user)',\n      'validateAuth(user)'\n    );\n    \n    expect(pattern?.context).toBe('function-call');\n  });\n});\n\ndescribe('PatternStore', () => {\n  let storage: MemoryStorage;\n  let patternStore: PatternStore;\n  \n  beforeEach(() => {\n    storage = new MemoryStorage(':memory:');\n    patternStore = new PatternStore(storage);\n  });\n  \n  it('should save patterns', () => {\n    const pattern: CorrectionPattern = {\n      original: 'var IDENTIFIER',\n      corrected: 'const IDENTIFIER',\n      context: 'variable-declaration',\n      frequency: 1\n    };\n    \n    patternStore.savePattern(pattern);\n    \n    const stats = storage.getStats();\n    expect(stats.total).toBe(1);\n    expect(stats.byType['correction-pattern']).toBe(1);\n  });\n  \n  it('should increment frequency for similar patterns', () => {\n    const pattern: CorrectionPattern = {\n      original: 'var IDENTIFIER',\n      corrected: 'const IDENTIFIER',\n      context: 'variable-declaration',\n      frequency: 1\n    };\n    \n    // Save same pattern twice\n    patternStore.savePattern(pattern);\n    patternStore.savePattern(pattern);\n    \n    const frequent = patternStore.getFrequentPatterns(2);\n    expect(frequent).toHaveLength(1);\n    expect(frequent[0].frequency).toBe(2);\n  });\n  \n  it('should retrieve frequent patterns', () => {\n    // Add various patterns\n    patternStore.savePattern({\n      original: 'var X',\n      corrected: 'const X',\n      context: 'variable',\n      frequency: 1\n    });\n    \n    // Make this one frequent\n    for (let i = 0; i < 3; i++) {\n      patternStore.savePattern({\n        original: 'getUserData',\n        corrected: 'fetchUserData',\n        context: 'function-call',\n        frequency: 1\n      });\n    }\n    \n    const frequent = patternStore.getFrequentPatterns(2);\n    expect(frequent).toHaveLength(1);\n    expect(frequent[0].original).toBe('getUserData');\n    expect(frequent[0].frequency).toBeGreaterThanOrEqual(3);\n  });\n});"],"version":3}