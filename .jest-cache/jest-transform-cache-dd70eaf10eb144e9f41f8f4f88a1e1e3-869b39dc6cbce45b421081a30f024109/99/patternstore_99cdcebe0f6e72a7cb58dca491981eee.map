{"file":"/mnt/c/Users/ebiarao/repos/claude-recall/src/memory/pattern-store.ts","mappings":";;;AAGA,MAAa,YAAY;IACvB,YAAoB,OAAsB;QAAtB,YAAO,GAAP,OAAO,CAAe;IAAG,CAAC;IAE9C,WAAW,CAAC,OAA0B;QACpC,MAAM,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;QAE3C,IAAI,QAAQ,EAAE,CAAC;YACb,QAAQ,CAAC,SAAS,EAAE,CAAC;YACrB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC;gBAChB,GAAG,EAAE,WAAW,QAAQ,CAAC,EAAE,EAAE;gBAC7B,KAAK,EAAE,QAAQ;gBACf,IAAI,EAAE,oBAAoB;gBAC1B,UAAU,EAAE,OAAO,CAAC,GAAG,CAAC,kBAAkB;gBAC1C,SAAS,EAAE,SAAS;gBACpB,SAAS,EAAE,IAAI,CAAC,GAAG,EAAE;gBACrB,eAAe,EAAE,QAAQ,CAAC,SAAS,GAAG,EAAE;aACzC,CAAC,CAAC;QACL,CAAC;aAAM,CAAC;YACN,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC;gBAChB,GAAG,EAAE,WAAW,IAAI,CAAC,GAAG,EAAE,EAAE;gBAC5B,KAAK,EAAE,OAAO;gBACd,IAAI,EAAE,oBAAoB;gBAC1B,UAAU,EAAE,OAAO,CAAC,GAAG,CAAC,kBAAkB;gBAC1C,SAAS,EAAE,SAAS;gBACpB,SAAS,EAAE,IAAI,CAAC,GAAG,EAAE;gBACrB,eAAe,EAAE,GAAG;aACrB,CAAC,CAAC;QACL,CAAC;IACH,CAAC;IAEO,WAAW,CAAC,OAA0B;QAC5C,wCAAwC;QACxC,MAAM,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,eAAe,CAAC;YAC5C,IAAI,EAAE,oBAAoB;YAC1B,UAAU,EAAE,OAAO,CAAC,GAAG,CAAC,kBAAkB;YAC1C,SAAS,EAAE,SAAS;SACrB,CAAC,CAAC;QAEH,KAAK,MAAM,MAAM,IAAI,QAAQ,EAAE,CAAC;YAC9B,MAAM,MAAM,GAAG,MAAM,CAAC,KAAY,CAAC;YACnC,IAAI,MAAM,CAAC,QAAQ,KAAK,OAAO,CAAC,QAAQ;gBACpC,MAAM,CAAC,SAAS,KAAK,OAAO,CAAC,SAAS;gBACtC,MAAM,CAAC,OAAO,KAAK,OAAO,CAAC,OAAO,EAAE,CAAC;gBACvC,OAAO;oBACL,GAAG,MAAM;oBACT,EAAE,EAAE,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,UAAU,EAAE,EAAE,CAAC;iBACvC,CAAC;YACJ,CAAC;QACH,CAAC;QAED,OAAO,IAAI,CAAC;IACd,CAAC;IAED,mBAAmB,CAAC,eAAuB,CAAC;QAC1C,MAAM,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,eAAe,CAAC;YAC5C,IAAI,EAAE,oBAAoB;YAC1B,UAAU,EAAE,OAAO,CAAC,GAAG,CAAC,kBAAkB;YAC1C,SAAS,EAAE,SAAS;SACrB,CAAC,CAAC;QAEH,OAAO,QAAQ;aACZ,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,KAA0B,CAAC;aACtC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,SAAS,IAAI,YAAY,CAAC;aACxC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,SAAS,GAAG,CAAC,CAAC,SAAS,CAAC,CAAC;IAC/C,CAAC;CACF;AAjED,oCAiEC","names":[],"sources":["/mnt/c/Users/ebiarao/repos/claude-recall/src/memory/pattern-store.ts"],"sourcesContent":["import { MemoryStorage } from './storage';\nimport { CorrectionPattern } from '../core/patterns';\n\nexport class PatternStore {\n  constructor(private storage: MemoryStorage) {}\n  \n  savePattern(pattern: CorrectionPattern): void {\n    const existing = this.findSimilar(pattern);\n    \n    if (existing) {\n      existing.frequency++;\n      this.storage.save({\n        key: `pattern_${existing.id}`,\n        value: existing,\n        type: 'correction-pattern',\n        project_id: process.env.CLAUDE_PROJECT_DIR,\n        file_path: undefined,\n        timestamp: Date.now(),\n        relevance_score: existing.frequency / 10\n      });\n    } else {\n      this.storage.save({\n        key: `pattern_${Date.now()}`,\n        value: pattern,\n        type: 'correction-pattern',\n        project_id: process.env.CLAUDE_PROJECT_DIR,\n        file_path: undefined,\n        timestamp: Date.now(),\n        relevance_score: 0.1\n      });\n    }\n  }\n  \n  private findSimilar(pattern: CorrectionPattern): any | null {\n    // Search for similar patterns in memory\n    const memories = this.storage.searchByContext({\n      type: 'correction-pattern',\n      project_id: process.env.CLAUDE_PROJECT_DIR,\n      file_path: undefined\n    });\n    \n    for (const memory of memories) {\n      const stored = memory.value as any;\n      if (stored.original === pattern.original && \n          stored.corrected === pattern.corrected &&\n          stored.context === pattern.context) {\n        return {\n          ...stored,\n          id: memory.key.replace('pattern_', '')\n        };\n      }\n    }\n    \n    return null;\n  }\n  \n  getFrequentPatterns(minFrequency: number = 2): CorrectionPattern[] {\n    const patterns = this.storage.searchByContext({\n      type: 'correction-pattern',\n      project_id: process.env.CLAUDE_PROJECT_DIR,\n      file_path: undefined\n    });\n    \n    return patterns\n      .map(m => m.value as CorrectionPattern)\n      .filter(p => p.frequency >= minFrequency)\n      .sort((a, b) => b.frequency - a.frequency);\n  }\n}"],"version":3}