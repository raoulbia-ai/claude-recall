{"file":"/mnt/c/Users/ebiarao/repos/claude-recall/tests/performance/queue-performance.test.ts","mappings":"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","names":[],"sources":["/mnt/c/Users/ebiarao/repos/claude-recall/tests/performance/queue-performance.test.ts"],"sourcesContent":["import { QueueSystem } from '../../src/services/queue-system';\nimport { QueueAPI } from '../../src/services/queue-api';\nimport { QueueIntegrationService } from '../../src/services/queue-integration';\nimport * as fs from 'fs';\nimport * as path from 'path';\n\ndescribe('Queue System Performance Tests', () => {\n  let queueSystem: QueueSystem;\n  let queueAPI: QueueAPI;\n  let testDbPath: string;\n\n  beforeEach(() => {\n    testDbPath = path.join(__dirname, `test-perf-${Date.now()}.db`);\n    \n    const mockConfig = {\n      getDatabasePath: () => testDbPath,\n      getProjectId: () => 'test-project'\n    };\n    \n    jest.doMock('../../src/services/config', () => ({\n      ConfigService: {\n        getInstance: () => mockConfig\n      }\n    }));\n\n    jest.doMock('../../src/services/logging', () => ({\n      LoggingService: {\n        getInstance: () => ({\n          info: jest.fn(),\n          warn: jest.fn(),\n          error: jest.fn(),\n          debug: jest.fn(),\n          logMemoryOperation: jest.fn(),\n          logRetrieval: jest.fn(),\n          logServiceError: jest.fn()\n        })\n      }\n    }));\n\n    queueSystem = QueueSystem.getInstance();\n    queueAPI = QueueAPI.getInstance();\n  });\n\n  afterEach(() => {\n    queueSystem.close();\n    queueAPI.close();\n    \n    if (fs.existsSync(testDbPath)) {\n      fs.unlinkSync(testDbPath);\n    }\n    \n    jest.clearAllMocks();\n    jest.resetModules();\n  });\n\n  describe('High Volume Message Processing', () => {\n    test('should handle 100 messages efficiently', async () => {\n      const messageCount = 100; // Reduced from 1000 for local development\n      const startTime = Date.now();\n      \n      // Enqueue messages\n      for (let i = 0; i < messageCount; i++) {\n        queueSystem.enqueue(\n          'perf-test',\n          'bulk-message',\n          { index: i, data: `test-data-${i}` },\n          { priority: Math.floor(Math.random() * 10) }\n        );\n      }\n      \n      const enqueueTime = Date.now() - startTime;\n      console.log(`Enqueued ${messageCount} messages in ${enqueueTime}ms`);\n      \n      // Dequeue and process messages\n      const dequeueStartTime = Date.now();\n      let processedCount = 0;\n      \n      while (processedCount < messageCount) {\n        const messages = queueSystem.dequeue('perf-test', 50); // Batch size 50\n        \n        for (const message of messages) {\n          // Simulate processing\n          queueSystem.markCompleted(message.id!);\n          processedCount++;\n        }\n        \n        if (messages.length === 0) {\n          // No more messages available\n          break;\n        }\n      }\n      \n      const dequeueTime = Date.now() - dequeueStartTime;\n      console.log(`Processed ${processedCount} messages in ${dequeueTime}ms`);\n      \n      // Verify all messages were processed\n      const stats = queueSystem.getQueueStats('perf-test');\n      expect(stats.completed).toBe(messageCount);\n      expect(stats.pending).toBe(0);\n      expect(stats.processing).toBe(0);\n      \n      // Performance assertions\n      expect(enqueueTime).toBeLessThan(1000); // Should enqueue 100 messages in under 1 second\n      expect(dequeueTime).toBeLessThan(2000); // Should process 100 messages in under 2 seconds\n    }, 30000); // 30 second timeout\n\n    test('should maintain performance with concurrent operations', async () => {\n      const concurrentOperations = 5; // Reduced from 10\n      const messagesPerOperation = 20; // Reduced from 100\n      \n      const startTime = Date.now();\n      \n      // Create concurrent enqueue operations\n      const enqueuePromises = Array.from({ length: concurrentOperations }, async (_, operationIndex) => {\n        for (let i = 0; i < messagesPerOperation; i++) {\n          queueSystem.enqueue(\n            `concurrent-queue-${operationIndex}`,\n            'concurrent-message',\n            { operationIndex, messageIndex: i }\n          );\n        }\n      });\n      \n      await Promise.all(enqueuePromises);\n      \n      const enqueueTime = Date.now() - startTime;\n      console.log(`Concurrent enqueue of ${concurrentOperations * messagesPerOperation} messages in ${enqueueTime}ms`);\n      \n      // Process all queues concurrently\n      const processStartTime = Date.now();\n      \n      const processPromises = Array.from({ length: concurrentOperations }, async (_, operationIndex) => {\n        const queueName = `concurrent-queue-${operationIndex}`;\n        let processed = 0;\n        \n        while (processed < messagesPerOperation) {\n          const messages = queueSystem.dequeue(queueName, 10);\n          \n          for (const message of messages) {\n            queueSystem.markCompleted(message.id!);\n            processed++;\n          }\n          \n          if (messages.length === 0) break;\n        }\n        \n        return processed;\n      });\n      \n      const results = await Promise.all(processPromises);\n      const processTime = Date.now() - processStartTime;\n      \n      console.log(`Concurrent processing completed in ${processTime}ms`);\n      \n      // Verify all messages were processed\n      const totalProcessed = results.reduce((sum, count) => sum + count, 0);\n      expect(totalProcessed).toBe(concurrentOperations * messagesPerOperation);\n      \n      // Performance assertions\n      expect(enqueueTime).toBeLessThan(2000); // Reduced from 8000\n      expect(processTime).toBeLessThan(3000); // Reduced from 15000\n    }, 45000);\n  });\n\n  describe('Priority Queue Performance', () => {\n    test('should maintain priority ordering under load', () => {\n      const messageCount = 500;\n      const priorities = [1, 3, 5, 7, 9];\n      \n      // Enqueue messages with random priorities\n      const enqueuedPriorities: number[] = [];\n      for (let i = 0; i < messageCount; i++) {\n        const priority = priorities[Math.floor(Math.random() * priorities.length)];\n        queueSystem.enqueue('priority-test', 'priority-message', { index: i }, { priority });\n        enqueuedPriorities.push(priority);\n      }\n      \n      // Dequeue all messages and verify priority ordering\n      const dequeuedPriorities: number[] = [];\n      let remainingMessages = messageCount;\n      \n      while (remainingMessages > 0) {\n        const messages = queueSystem.dequeue('priority-test', 25);\n        \n        for (const message of messages) {\n          dequeuedPriorities.push(message.priority);\n          queueSystem.markCompleted(message.id!);\n          remainingMessages--;\n        }\n        \n        if (messages.length === 0) break;\n      }\n      \n      // Verify priority ordering is maintained\n      for (let i = 1; i < dequeuedPriorities.length; i++) {\n        expect(dequeuedPriorities[i]).toBeLessThanOrEqual(dequeuedPriorities[i - 1]);\n      }\n      \n      expect(dequeuedPriorities.length).toBe(messageCount);\n    });\n  });\n\n  describe('Retry Mechanism Performance', () => {\n    test('should handle retry processing efficiently', async () => {\n      const messageCount = 100;\n      const maxRetries = 3;\n      \n      // Enqueue messages that will fail\n      const messageIds: number[] = [];\n      for (let i = 0; i < messageCount; i++) {\n        const id = queueSystem.enqueue(\n          'retry-test',\n          'failing-message',\n          { willFail: true, index: i },\n          { maxRetries }\n        );\n        messageIds.push(id);\n      }\n      \n      const startTime = Date.now();\n      \n      // Process and fail messages multiple times\n      for (let retryAttempt = 0; retryAttempt <= maxRetries; retryAttempt++) {\n        const messages = queueSystem.dequeue('retry-test', messageCount);\n        \n        for (const message of messages) {\n          // Simulate failure\n          queueSystem.markFailed(message.id!, `Attempt ${retryAttempt + 1} failed`);\n        }\n        \n        // Small delay to allow retry scheduling\n        await new Promise(resolve => setTimeout(resolve, 100));\n      }\n      \n      const processingTime = Date.now() - startTime;\n      console.log(`Retry processing completed in ${processingTime}ms`);\n      \n      // Verify final state\n      const stats = queueSystem.getQueueStats('retry-test');\n      expect(stats.failed).toBe(messageCount);\n      expect(stats.retrying).toBe(0);\n      \n      // Check dead letter queue\n      const db = queueSystem['db'];\n      const dlqCount = db.prepare('SELECT COUNT(*) as count FROM dead_letter_queue').get() as any;\n      expect(dlqCount.count).toBe(messageCount);\n      \n      // Performance assertion\n      expect(processingTime).toBeLessThan(5000);\n    }, 15000);\n  });\n\n  describe('Database Performance Under Load', () => {\n    test('should maintain database performance with large message volumes', () => {\n      const largeMessageCount = 2000;\n      const batchSize = 100;\n      \n      const startTime = Date.now();\n      \n      // Insert messages in batches\n      for (let batch = 0; batch < largeMessageCount / batchSize; batch++) {\n        for (let i = 0; i < batchSize; i++) {\n          const messageIndex = batch * batchSize + i;\n          queueSystem.enqueue(\n            'load-test',\n            'load-message',\n            { \n              batch,\n              index: messageIndex,\n              data: `load-test-data-${messageIndex}`,\n              timestamp: Date.now()\n            },\n            { priority: messageIndex % 5 }\n          );\n        }\n      }\n      \n      const insertTime = Date.now() - startTime;\n      console.log(`Inserted ${largeMessageCount} messages in ${insertTime}ms`);\n      \n      // Test query performance\n      const queryStartTime = Date.now();\n      \n      // Test various query patterns\n      const stats = queueSystem.getQueueStats('load-test');\n      const messages = queueSystem.dequeue('load-test', 50);\n      const health = queueAPI.getSystemHealth();\n      \n      const queryTime = Date.now() - queryStartTime;\n      console.log(`Query operations completed in ${queryTime}ms`);\n      \n      // Verify data integrity\n      expect(stats.pending).toBe(largeMessageCount - messages.length);\n      expect(messages.length).toBe(50);\n      expect(health.totalPendingMessages).toBeGreaterThan(0);\n      \n      // Performance assertions\n      expect(insertTime).toBeLessThan(2000); // 2 seconds for reduced inserts\n      expect(queryTime).toBeLessThan(1000); // 1 second for query operations\n    });\n\n    test('should handle database cleanup efficiently', () => {\n      const messageCount = 500;\n      \n      // Create and complete messages\n      for (let i = 0; i < messageCount; i++) {\n        const id = queueSystem.enqueue('cleanup-test', 'cleanup-message', { index: i });\n        const messages = queueSystem.dequeue('cleanup-test', 1);\n        queueSystem.markCompleted(messages[0].id!);\n      }\n      \n      // Manually set old timestamps for cleanup test\n      const db = queueSystem['db'];\n      const oldTime = Date.now() - (8 * 24 * 60 * 60 * 1000); // 8 days ago\n      db.prepare('UPDATE queue_messages SET processed_at = ? WHERE queue_name = ?')\n        .run(oldTime, 'cleanup-test');\n      \n      const cleanupStartTime = Date.now();\n      \n      // Trigger cleanup\n      queueSystem['cleanupOldMessages']();\n      \n      const cleanupTime = Date.now() - cleanupStartTime;\n      console.log(`Cleanup completed in ${cleanupTime}ms`);\n      \n      // Verify cleanup worked\n      const remainingCount = db.prepare('SELECT COUNT(*) as count FROM queue_messages WHERE queue_name = ?')\n        .get('cleanup-test') as any;\n      expect(remainingCount.count).toBe(0);\n      \n      // Performance assertion\n      expect(cleanupTime).toBeLessThan(2000); // Cleanup should be fast\n    });\n  });\n\n  describe('Memory Usage Performance', () => {\n    test('should maintain reasonable memory usage under load', async () => {\n      const initialMemory = process.memoryUsage();\n      \n      // Process a large number of messages\n      const messageCount = 100; // Reduced from 1000\n      const batches = 10;\n      const messagesPerBatch = messageCount / batches;\n      \n      for (let batch = 0; batch < batches; batch++) {\n        // Enqueue batch\n        for (let i = 0; i < messagesPerBatch; i++) {\n          queueSystem.enqueue('memory-test', 'memory-message', {\n            batch,\n            index: i,\n            data: new Array(100).fill(`data-${batch}-${i}`).join('')\n          });\n        }\n        \n        // Process batch\n        let processed = 0;\n        while (processed < messagesPerBatch) {\n          const messages = queueSystem.dequeue('memory-test', 20);\n          \n          for (const message of messages) {\n            queueSystem.markCompleted(message.id!);\n            processed++;\n          }\n          \n          if (messages.length === 0) break;\n        }\n        \n        // Force garbage collection if available\n        if (global.gc) {\n          global.gc();\n        }\n      }\n      \n      const finalMemory = process.memoryUsage();\n      const memoryIncrease = finalMemory.heapUsed - initialMemory.heapUsed;\n      \n      console.log(`Memory increase: ${Math.round(memoryIncrease / 1024 / 1024)}MB`);\n      \n      // Memory should not increase excessively\n      expect(memoryIncrease).toBeLessThan(50 * 1024 * 1024); // Less than 50MB increase\n    }, 30000);\n  });\n\n  describe('Integration Performance', () => {\n    test('should handle queue integration service under load', async () => {\n      const integrationService = QueueIntegrationService.getInstance();\n      await integrationService.initialize();\n      \n      const operationCount = 200;\n      const startTime = Date.now();\n      \n      // Mix of different operation types\n      for (let i = 0; i < operationCount; i++) {\n        const operationType = i % 4;\n        \n        switch (operationType) {\n          case 0:\n            integrationService.processHookEvent('load-test-hook', { index: i });\n            break;\n          case 1:\n            integrationService.processMCPOperation('load-test-tool', 'operation', { index: i });\n            break;\n          case 2:\n            integrationService.processMemoryOperation('store', { key: `load-${i}`, value: `value-${i}` });\n            break;\n          case 3:\n            queueAPI.enqueuePatternDetection(`Load test content ${i}`, { index: i });\n            break;\n        }\n      }\n      \n      const enqueueTime = Date.now() - startTime;\n      console.log(`Integration service enqueued ${operationCount} operations in ${enqueueTime}ms`);\n      \n      // Verify all operations were queued\n      const health = integrationService.getSystemHealth();\n      expect(health.totalPendingMessages).toBeGreaterThan(0);\n      \n      // Performance assertion\n      expect(enqueueTime).toBeLessThan(5000); // Should handle 200 operations in under 5 seconds\n      \n      integrationService.shutdown();\n    }, 15000);\n  });\n});"],"version":3}