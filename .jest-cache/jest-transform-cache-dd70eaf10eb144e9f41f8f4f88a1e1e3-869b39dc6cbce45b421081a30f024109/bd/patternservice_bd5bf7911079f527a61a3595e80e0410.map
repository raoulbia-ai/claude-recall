{"file":"/mnt/c/Users/ebiarao/repos/claude-recall/src/services/pattern-service.ts","mappings":";;;AAAA,+DAA4E;AAM5E,MAAa,cAAc;IAIzB;QACE,IAAI,CAAC,QAAQ,GAAG,IAAI,kCAAe,EAAE,CAAC;IACxC,CAAC;IAED,MAAM,CAAC,WAAW;QAChB,IAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,CAAC;YAC7B,cAAc,CAAC,QAAQ,GAAG,IAAI,cAAc,EAAE,CAAC;QACjD,CAAC;QACD,OAAO,cAAc,CAAC,QAAQ,CAAC;IACjC,CAAC;IAED,aAAa,CAAC,MAAc;QAC1B,OAAO,IAAI,CAAC,QAAQ,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC;IAC9C,CAAC;IAED,cAAc,CAAC,eAAwB,EAAE,MAAc;QACrD,MAAM,gBAAgB,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;QAEpD,MAAM,eAAe,GAAY;YAC/B,GAAG,eAAe;YAClB,gBAAgB,EAAE,gBAAgB;SACnC,CAAC;QAEF,+DAA+D;QAC/D,IAAI,gBAAgB,CAAC,QAAQ,EAAE,CAAC;YAC9B,eAAe,CAAC,QAAQ,GAAG,gBAAgB,CAAC,QAAQ,CAAC;YACrD,eAAe,CAAC,mBAAmB,GAAG,IAAI,CAAC,sBAAsB,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;QAC/F,CAAC;QAED,IAAI,gBAAgB,CAAC,QAAQ,EAAE,CAAC;YAC9B,eAAe,CAAC,eAAe,GAAG,gBAAgB,CAAC,QAAQ,CAAC;YAC5D,eAAe,CAAC,qBAAqB,GAAG,IAAI,CAAC,gBAAgB,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;QAC3F,CAAC;QAED,IAAI,gBAAgB,CAAC,SAAS,EAAE,CAAC;YAC/B,eAAe,CAAC,gBAAgB,GAAG,gBAAgB,CAAC,SAAS,CAAC;YAC9D,eAAe,CAAC,yBAAyB,GAAG,IAAI,CAAC,oBAAoB,CAAC,gBAAgB,CAAC,SAAS,CAAC,CAAC;QACpG,CAAC;QAED,IAAI,gBAAgB,CAAC,QAAQ,IAAI,gBAAgB,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;YACtE,eAAe,CAAC,iBAAiB,GAAG,gBAAgB,CAAC,QAAQ,CAAC;YAC9D,eAAe,CAAC,WAAW,GAAG,IAAI,CAAC,gBAAgB,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;QACjF,CAAC;QAED,OAAO,eAAe,CAAC;IACzB,CAAC;IAEO,sBAAsB,CAAC,QAAgB;QAC7C,MAAM,YAAY,GAA2B;YAC3C,aAAa,EAAE;gBACb,gBAAgB,EAAE,CAAC,gCAAgC,EAAE,yBAAyB,EAAE,sBAAsB,CAAC;gBACvG,cAAc,EAAE,CAAC,oBAAoB,EAAE,iBAAiB,EAAE,gBAAgB,CAAC;gBAC3E,YAAY,EAAE,CAAC,UAAU,EAAE,UAAU,EAAE,aAAa,CAAC;aACtD;YACD,SAAS,EAAE;gBACT,gBAAgB,EAAE,CAAC,iBAAiB,EAAE,qBAAqB,EAAE,YAAY,CAAC;gBAC1E,cAAc,EAAE,CAAC,kBAAkB,EAAE,uBAAuB,EAAE,iBAAiB,CAAC;gBAChF,eAAe,EAAE,CAAC,gBAAgB,EAAE,YAAY,EAAE,oBAAoB,CAAC;aACxE;YACD,UAAU,EAAE;gBACV,gBAAgB,EAAE,CAAC,sBAAsB,EAAE,mBAAmB,EAAE,qBAAqB,CAAC;gBACtF,mBAAmB,EAAE,CAAC,gBAAgB,EAAE,iBAAiB,EAAE,sBAAsB,CAAC;gBAClF,cAAc,EAAE,CAAC,uBAAuB,EAAE,kBAAkB,EAAE,UAAU,CAAC;aAC1E;YACD,aAAa,EAAE;gBACb,gBAAgB,EAAE,CAAC,yBAAyB,EAAE,qBAAqB,EAAE,yBAAyB,CAAC;gBAC/F,oBAAoB,EAAE,CAAC,aAAa,EAAE,iBAAiB,EAAE,aAAa,CAAC;gBACvE,iBAAiB,EAAE,CAAC,eAAe,EAAE,iBAAiB,EAAE,eAAe,CAAC;aACzE;YACD,SAAS,EAAE;gBACT,gBAAgB,EAAE,CAAC,kBAAkB,EAAE,iBAAiB,EAAE,eAAe,CAAC;gBAC1E,oBAAoB,EAAE,CAAC,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,CAAC;gBACpD,UAAU,EAAE,CAAC,UAAU,EAAE,eAAe,EAAE,aAAa,CAAC;aACzD;YACD,QAAQ,EAAE;gBACR,gBAAgB,EAAE,CAAC,mBAAmB,EAAE,gBAAgB,EAAE,sBAAsB,CAAC;gBACjF,eAAe,EAAE,CAAC,eAAe,EAAE,aAAa,EAAE,UAAU,EAAE,iBAAiB,CAAC;gBAChF,YAAY,EAAE,CAAC,YAAY,EAAE,gBAAgB,EAAE,eAAe,CAAC;aAChE;SACF,CAAC;QAEF,OAAO,YAAY,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;IACtC,CAAC;IAEO,gBAAgB,CAAC,QAAgB;QACvC,MAAM,aAAa,GAA2B;YAC5C,YAAY,EAAE;gBACZ,aAAa,EAAE,CAAC,kBAAkB,EAAE,WAAW,EAAE,mBAAmB,CAAC;gBACrE,WAAW,EAAE,CAAC,KAAK,EAAE,SAAS,EAAE,QAAQ,CAAC;gBACzC,cAAc,EAAE,CAAC,KAAK,EAAE,MAAM,EAAE,OAAO,CAAC;aACzC;YACD,YAAY,EAAE;gBACZ,aAAa,EAAE,CAAC,eAAe,EAAE,WAAW,EAAE,qBAAqB,CAAC;gBACpE,WAAW,EAAE,CAAC,MAAM,EAAE,KAAK,EAAE,QAAQ,CAAC;gBACtC,cAAc,EAAE,CAAC,KAAK,EAAE,MAAM,EAAE,MAAM,CAAC;aACxC;YACD,QAAQ,EAAE;gBACR,aAAa,EAAE,CAAC,cAAc,EAAE,gBAAgB,EAAE,sBAAsB,CAAC;gBACzE,WAAW,EAAE,CAAC,KAAK,EAAE,QAAQ,EAAE,OAAO,CAAC;gBACvC,cAAc,EAAE,CAAC,KAAK,EAAE,MAAM,EAAE,MAAM,CAAC;aACxC;YACD,MAAM,EAAE;gBACN,aAAa,EAAE,CAAC,2BAA2B,EAAE,cAAc,EAAE,2BAA2B,CAAC;gBACzF,WAAW,EAAE,CAAC,OAAO,EAAE,QAAQ,EAAE,OAAO,CAAC;gBACzC,cAAc,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,QAAQ,CAAC;aAC5C;YACD,IAAI,EAAE;gBACJ,aAAa,EAAE,CAAC,0BAA0B,EAAE,uBAAuB,EAAE,gBAAgB,CAAC;gBACtF,WAAW,EAAE,CAAC,QAAQ,EAAE,SAAS,EAAE,QAAQ,CAAC;gBAC5C,cAAc,EAAE,CAAC,KAAK,EAAE,MAAM,CAAC;aAChC;SACF,CAAC;QAEF,OAAO,aAAa,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;IACvC,CAAC;IAEO,oBAAoB,CAAC,SAAiB;QAC5C,MAAM,iBAAiB,GAA2B;YAChD,OAAO,EAAE;gBACP,iBAAiB,EAAE,CAAC,uBAAuB,EAAE,OAAO,EAAE,SAAS,CAAC;gBAChE,eAAe,EAAE,CAAC,UAAU,EAAE,YAAY,EAAE,OAAO,EAAE,aAAa,CAAC;gBACnE,eAAe,EAAE,CAAC,cAAc,EAAE,OAAO,EAAE,mBAAmB,CAAC;aAChE;YACD,SAAS,EAAE;gBACT,oBAAoB,EAAE,CAAC,KAAK,EAAE,UAAU,EAAE,kBAAkB,CAAC;gBAC7D,gBAAgB,EAAE,CAAC,aAAa,EAAE,MAAM,EAAE,QAAQ,EAAE,QAAQ,CAAC;gBAC7D,eAAe,EAAE,CAAC,kBAAkB,EAAE,eAAe,EAAE,gBAAgB,CAAC;aACzE;YACD,MAAM,EAAE;gBACN,YAAY,EAAE,CAAC,YAAY,EAAE,mBAAmB,EAAE,SAAS,CAAC;gBAC5D,QAAQ,EAAE,CAAC,MAAM,EAAE,SAAS,EAAE,kBAAkB,CAAC;gBACjD,UAAU,EAAE,CAAC,gBAAgB,EAAE,eAAe,CAAC;aAChD;YACD,KAAK,EAAE;gBACL,iBAAiB,EAAE,CAAC,wBAAwB,EAAE,iBAAiB,EAAE,aAAa,CAAC;gBAC/E,eAAe,EAAE,CAAC,MAAM,EAAE,OAAO,EAAE,UAAU,EAAE,KAAK,CAAC;gBACrD,UAAU,EAAE,CAAC,MAAM,EAAE,OAAO,EAAE,SAAS,EAAE,QAAQ,CAAC;aACnD;YACD,QAAQ,EAAE;gBACR,oBAAoB,EAAE,CAAC,KAAK,EAAE,gBAAgB,EAAE,KAAK,CAAC;gBACtD,UAAU,EAAE,CAAC,MAAM,EAAE,OAAO,EAAE,cAAc,CAAC;gBAC7C,WAAW,EAAE,CAAC,MAAM,EAAE,SAAS,EAAE,WAAW,CAAC;aAC9C;SACF,CAAC;QAEF,OAAO,iBAAiB,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC;IAC5C,CAAC;IAEO,gBAAgB,CAAC,QAAkB;QACzC,MAAM,UAAU,GAAgC;YAC9C,KAAK,EAAE,EAAE;YACT,SAAS,EAAE,EAAE;YACb,OAAO,EAAE,EAAE;YACX,OAAO,EAAE,EAAE;YACX,KAAK,EAAE,EAAE;SACV,CAAC;QAEF,KAAK,MAAM,MAAM,IAAI,QAAQ,EAAE,CAAC;YAC9B,IAAI,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC;gBAClD,UAAU,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAChC,CAAC;iBAAM,IAAI,sBAAsB,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC;gBAC/C,UAAU,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YACpC,CAAC;iBAAM,IAAI,qBAAqB,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC;gBAC9C,UAAU,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAClC,CAAC;iBAAM,IAAI,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,iBAAiB,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC;gBAClE,UAAU,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAClC,CAAC;iBAAM,CAAC;gBACN,UAAU,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAChC,CAAC;QACH,CAAC;QAED,0BAA0B;QAC1B,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;YACpC,IAAI,UAAU,CAAC,GAAG,CAAC,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;gBACjC,OAAO,UAAU,CAAC,GAAG,CAAC,CAAC;YACzB,CAAC;QACH,CAAC,CAAC,CAAC;QAEH,OAAO,UAAU,CAAC;IACpB,CAAC;CACF;AAxLD,wCAwLC","names":[],"sources":["/mnt/c/Users/ebiarao/repos/claude-recall/src/services/pattern-service.ts"],"sourcesContent":["import { PatternDetector, DetectedPattern } from '../core/pattern-detector';\n\ninterface Context {\n  [key: string]: any;\n}\n\nexport class PatternService {\n  private static instance: PatternService;\n  private detector: PatternDetector;\n\n  private constructor() {\n    this.detector = new PatternDetector();\n  }\n\n  static getInstance(): PatternService {\n    if (!PatternService.instance) {\n      PatternService.instance = new PatternService();\n    }\n    return PatternService.instance;\n  }\n\n  analyzePrompt(prompt: string): DetectedPattern {\n    return this.detector.detectPatterns(prompt);\n  }\n\n  enhanceContext(existingContext: Context, prompt: string): Context {\n    const detectedPatterns = this.analyzePrompt(prompt);\n    \n    const enhancedContext: Context = {\n      ...existingContext,\n      detectedPatterns: detectedPatterns\n    };\n\n    // Add specific context enhancements based on detected patterns\n    if (detectedPatterns.taskType) {\n      enhancedContext.taskType = detectedPatterns.taskType;\n      enhancedContext.taskSpecificContext = this.getTaskSpecificContext(detectedPatterns.taskType);\n    }\n\n    if (detectedPatterns.language) {\n      enhancedContext.primaryLanguage = detectedPatterns.language;\n      enhancedContext.languageSpecificHints = this.getLanguageHints(detectedPatterns.language);\n    }\n\n    if (detectedPatterns.framework) {\n      enhancedContext.primaryFramework = detectedPatterns.framework;\n      enhancedContext.frameworkSpecificPatterns = this.getFrameworkPatterns(detectedPatterns.framework);\n    }\n\n    if (detectedPatterns.entities && detectedPatterns.entities.length > 0) {\n      enhancedContext.mentionedEntities = detectedPatterns.entities;\n      enhancedContext.entityTypes = this.classifyEntities(detectedPatterns.entities);\n    }\n\n    return enhancedContext;\n  }\n\n  private getTaskSpecificContext(taskType: string): any {\n    const taskContexts: { [key: string]: any } = {\n      'create_test': {\n        suggestedActions: ['analyze existing test patterns', 'identify test framework', 'determine test scope'],\n        commonPatterns: ['arrange-act-assert', 'given-when-then', 'setup-teardown'],\n        relatedFiles: ['*.test.*', '*.spec.*', '__tests__/*']\n      },\n      'fix_bug': {\n        suggestedActions: ['reproduce issue', 'identify root cause', 'verify fix'],\n        debuggingHints: ['check error logs', 'review recent changes', 'validate inputs'],\n        relatedConcepts: ['error handling', 'edge cases', 'regression testing']\n      },\n      'refactor': {\n        suggestedActions: ['identify code smells', 'maintain behavior', 'improve readability'],\n        refactoringPatterns: ['extract method', 'rename variable', 'simplify conditional'],\n        qualityMetrics: ['cyclomatic complexity', 'code duplication', 'coupling']\n      },\n      'add_feature': {\n        suggestedActions: ['understand requirements', 'design architecture', 'implement incrementally'],\n        designConsiderations: ['scalability', 'maintainability', 'testability'],\n        integrationPoints: ['API endpoints', 'database schema', 'UI components']\n      },\n      'explain': {\n        suggestedActions: ['provide overview', 'explain details', 'give examples'],\n        explanationStructure: ['what', 'why', 'how', 'when'],\n        visualAids: ['diagrams', 'code snippets', 'flow charts']\n      },\n      'review': {\n        suggestedActions: ['check correctness', 'assess quality', 'suggest improvements'],\n        reviewChecklist: ['functionality', 'performance', 'security', 'maintainability'],\n        commonIssues: ['code style', 'error handling', 'documentation']\n      }\n    };\n\n    return taskContexts[taskType] || {};\n  }\n\n  private getLanguageHints(language: string): any {\n    const languageHints: { [key: string]: any } = {\n      'typescript': {\n        bestPractices: ['use strict types', 'avoid any', 'prefer interfaces'],\n        commonTools: ['tsc', 'ts-node', 'eslint'],\n        fileExtensions: ['.ts', '.tsx', '.d.ts']\n      },\n      'javascript': {\n        bestPractices: ['use const/let', 'avoid var', 'use arrow functions'],\n        commonTools: ['node', 'npm', 'eslint'],\n        fileExtensions: ['.js', '.jsx', '.mjs']\n      },\n      'python': {\n        bestPractices: ['follow PEP 8', 'use type hints', 'virtual environments'],\n        commonTools: ['pip', 'pytest', 'black'],\n        fileExtensions: ['.py', '.pyw', '.pyi']\n      },\n      'java': {\n        bestPractices: ['follow naming conventions', 'use generics', 'proper exception handling'],\n        commonTools: ['maven', 'gradle', 'junit'],\n        fileExtensions: ['.java', '.jar', '.class']\n      },\n      'go': {\n        bestPractices: ['handle errors explicitly', 'use goroutines wisely', 'keep it simple'],\n        commonTools: ['go mod', 'go test', 'golint'],\n        fileExtensions: ['.go', '.mod']\n      }\n    };\n\n    return languageHints[language] || {};\n  }\n\n  private getFrameworkPatterns(framework: string): any {\n    const frameworkPatterns: { [key: string]: any } = {\n      'react': {\n        componentPatterns: ['functional components', 'hooks', 'context'],\n        stateManagement: ['useState', 'useReducer', 'Redux', 'Context API'],\n        commonLibraries: ['react-router', 'axios', 'styled-components']\n      },\n      'express': {\n        architecturePatterns: ['MVC', 'REST API', 'middleware chain'],\n        commonMiddleware: ['body-parser', 'cors', 'helmet', 'morgan'],\n        routingPatterns: ['route parameters', 'query strings', 'route handlers']\n      },\n      'jest': {\n        testPatterns: ['unit tests', 'integration tests', 'mocking'],\n        matchers: ['toBe', 'toEqual', 'toHaveBeenCalled'],\n        setupFiles: ['jest.config.js', 'setupTests.js']\n      },\n      'vue': {\n        componentPatterns: ['single file components', 'composition API', 'options API'],\n        stateManagement: ['Vuex', 'Pinia', 'reactive', 'ref'],\n        directives: ['v-if', 'v-for', 'v-model', 'v-show']\n      },\n      'django': {\n        architecturePatterns: ['MVT', 'apps structure', 'ORM'],\n        commonApps: ['auth', 'admin', 'contenttypes'],\n        urlPatterns: ['path', 'include', 'namespace']\n      }\n    };\n\n    return frameworkPatterns[framework] || {};\n  }\n\n  private classifyEntities(entities: string[]): { [key: string]: string[] } {\n    const classified: { [key: string]: string[] } = {\n      files: [],\n      functions: [],\n      classes: [],\n      strings: [],\n      other: []\n    };\n\n    for (const entity of entities) {\n      if (entity.includes('.') && /\\.\\w+$/.test(entity)) {\n        classified.files.push(entity);\n      } else if (/^[a-z][a-zA-Z0-9_]*$/.test(entity)) {\n        classified.functions.push(entity);\n      } else if (/^[A-Z][a-zA-Z0-9]+$/.test(entity)) {\n        classified.classes.push(entity);\n      } else if (entity.includes(' ') || /[^a-zA-Z0-9._-]/.test(entity)) {\n        classified.strings.push(entity);\n      } else {\n        classified.other.push(entity);\n      }\n    }\n\n    // Remove empty categories\n    Object.keys(classified).forEach(key => {\n      if (classified[key].length === 0) {\n        delete classified[key];\n      }\n    });\n\n    return classified;\n  }\n}"],"version":3}