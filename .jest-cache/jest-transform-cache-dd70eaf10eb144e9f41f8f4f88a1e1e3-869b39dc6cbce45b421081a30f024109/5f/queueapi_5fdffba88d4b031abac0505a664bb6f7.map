{"file":"/mnt/c/Users/ebiarao/repos/claude-recall/src/services/queue-api.ts","mappings":"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","names":[],"sources":["/mnt/c/Users/ebiarao/repos/claude-recall/src/services/queue-api.ts"],"sourcesContent":["import { QueueSystem, QueueMessage, QueueStats, QueueProcessor } from './queue-system';\nimport { LoggingService } from './logging';\n\n/**\n * High-level API for queue operations\n * Provides a simplified interface for common queue operations\n */\nexport class QueueAPI {\n  private static instance: QueueAPI;\n  private queueSystem: QueueSystem;\n  private logger = LoggingService.getInstance();\n\n  private constructor() {\n    this.queueSystem = QueueSystem.getInstance();\n  }\n\n  static getInstance(): QueueAPI {\n    if (!QueueAPI.instance) {\n      QueueAPI.instance = new QueueAPI();\n    }\n    return QueueAPI.instance;\n  }\n\n  /**\n   * Enqueue a hook event for processing\n   */\n  enqueueHookEvent(\n    eventType: string,\n    payload: any,\n    options: {\n      priority?: number;\n      delayMs?: number;\n      correlationId?: string;\n      maxRetries?: number;\n    } = {}\n  ): number {\n    const scheduledAt = options.delayMs ? Date.now() + options.delayMs : undefined;\n    \n    return this.queueSystem.enqueue(\n      'hook-events',\n      eventType,\n      payload,\n      {\n        priority: options.priority || 0,\n        scheduledAt,\n        maxRetries: options.maxRetries || 3,\n        correlationId: options.correlationId,\n        metadata: {\n          source: 'hook',\n          eventType\n        }\n      }\n    );\n  }\n\n  /**\n   * Enqueue an MCP tool operation for processing\n   */\n  enqueueMCPOperation(\n    toolName: string,\n    operation: string,\n    payload: any,\n    options: {\n      priority?: number;\n      delayMs?: number;\n      correlationId?: string;\n      maxRetries?: number;\n    } = {}\n  ): number {\n    const scheduledAt = options.delayMs ? Date.now() + options.delayMs : undefined;\n    \n    return this.queueSystem.enqueue(\n      'mcp-operations',\n      `${toolName}:${operation}`,\n      payload,\n      {\n        priority: options.priority || 0,\n        scheduledAt,\n        maxRetries: options.maxRetries || 5, // MCP operations get more retries\n        correlationId: options.correlationId,\n        metadata: {\n          source: 'mcp',\n          toolName,\n          operation\n        }\n      }\n    );\n  }\n\n  /**\n   * Enqueue a memory operation for processing\n   */\n  enqueueMemoryOperation(\n    operation: 'store' | 'search' | 'update' | 'delete',\n    payload: any,\n    options: {\n      priority?: number;\n      delayMs?: number;\n      correlationId?: string;\n      maxRetries?: number;\n    } = {}\n  ): number {\n    const scheduledAt = options.delayMs ? Date.now() + options.delayMs : undefined;\n    \n    return this.queueSystem.enqueue(\n      'memory-operations',\n      operation,\n      payload,\n      {\n        priority: options.priority || 0,\n        scheduledAt,\n        maxRetries: options.maxRetries || 3,\n        correlationId: options.correlationId,\n        metadata: {\n          source: 'memory',\n          operation\n        }\n      }\n    );\n  }\n\n  /**\n   * Enqueue a pattern detection task\n   */\n  enqueuePatternDetection(\n    content: string,\n    context: any,\n    options: {\n      priority?: number;\n      delayMs?: number;\n      correlationId?: string;\n      maxRetries?: number;\n    } = {}\n  ): number {\n    const scheduledAt = options.delayMs ? Date.now() + options.delayMs : undefined;\n    \n    return this.queueSystem.enqueue(\n      'pattern-detection',\n      'detect-patterns',\n      {\n        content,\n        context\n      },\n      {\n        priority: options.priority || 0,\n        scheduledAt,\n        maxRetries: options.maxRetries || 2,\n        correlationId: options.correlationId,\n        metadata: {\n          source: 'pattern-detector',\n          contentLength: content.length\n        }\n      }\n    );\n  }\n\n  /**\n   * Peek at pending messages in a queue without removing them\n   */\n  peekMessages(queueName: string, limit: number = 10): QueueMessage[] {\n    // Use the proper accessor method for database queries\n    const now = Date.now();\n    const messages = this.queueSystem.executeQuery<QueueMessage>(`\n      SELECT * FROM queue_messages \n      WHERE queue_name = ? \n        AND status IN ('pending', 'retrying')\n        AND scheduled_at <= ?\n        AND (next_retry_at IS NULL OR next_retry_at <= ?)\n      ORDER BY priority DESC, created_at ASC \n      LIMIT ?\n    `, [queueName, now, now, limit]);\n    \n    // Parse JSON fields for display\n    return messages.map(message => ({\n      ...message,\n      payload: this.safeJsonParse(message.payload),\n      metadata: message.metadata ? this.safeJsonParse(message.metadata) : null\n    }));\n  }\n\n  /**\n   * Get queue statistics for monitoring\n   */\n  getQueueStats(queueName?: string): QueueStats | QueueStats[] {\n    if (queueName) {\n      return this.queueSystem.getQueueStats(queueName);\n    }\n\n    // Get stats for all queues using proper accessor method\n    const queueNames = this.queueSystem.getQueueNames();\n    \n    return queueNames.map(name => this.queueSystem.getQueueStats(name));\n  }\n\n  /**\n   * Get dead letter queue messages\n   */\n  getDeadLetterMessages(limit: number = 50): any[] {\n    const messages = this.queueSystem.executeQuery<any>(`\n      SELECT * FROM dead_letter_queue \n      ORDER BY failed_at DESC \n      LIMIT ?\n    `, [limit]);\n    \n    // Parse JSON fields\n    return messages.map(message => ({\n      ...message,\n      payload: this.safeJsonParse(message.payload),\n      metadata: message.metadata ? this.safeJsonParse(message.metadata) : null\n    }));\n  }\n\n  /**\n   * Requeue messages from dead letter queue\n   */\n  requeueFromDeadLetter(messageIds: number[]): number {\n    let requeuedCount = 0;\n    \n    this.queueSystem.executeTransaction((db) => {\n      const selectStmt = db.prepare('SELECT * FROM dead_letter_queue WHERE id = ?');\n      const deleteStmt = db.prepare('DELETE FROM dead_letter_queue WHERE id = ?');\n      \n      for (const messageId of messageIds) {\n        const dlqMessage = selectStmt.get(messageId) as any;\n        if (dlqMessage) {\n          // Re-enqueue the message\n          this.queueSystem.enqueue(\n            dlqMessage.original_queue_name,\n            dlqMessage.message_type,\n            this.safeJsonParse(dlqMessage.payload),\n            {\n              correlationId: dlqMessage.correlation_id,\n              metadata: dlqMessage.metadata ? this.safeJsonParse(dlqMessage.metadata) : undefined\n            }\n          );\n          \n          // Remove from dead letter queue\n          deleteStmt.run(messageId);\n          requeuedCount++;\n        }\n      }\n    });\n    \n    this.logger.info('QueueAPI', 'Messages requeued from dead letter queue', {\n      count: requeuedCount,\n      requestedCount: messageIds.length\n    });\n    \n    return requeuedCount;\n  }\n\n  /**\n   * Purge old completed messages manually\n   */\n  purgeCompletedMessages(olderThanDays: number = 1): number {\n    const cutoffTime = Date.now() - (olderThanDays * 24 * 60 * 60 * 1000);\n    \n    let deletedCount = 0;\n    this.queueSystem.executeTransaction((db) => {\n      const stmt = db.prepare(`\n        DELETE FROM queue_messages \n        WHERE status = 'completed' \n          AND processed_at < ?\n      `);\n      \n      const result = stmt.run(cutoffTime);\n      deletedCount = result.changes as number;\n    });\n    \n    this.logger.info('QueueAPI', 'Purged completed messages', {\n      count: deletedCount,\n      olderThanDays\n    });\n    \n    return deletedCount;\n  }\n\n  /**\n   * Register a processor for a queue\n   */\n  registerProcessor(queueName: string, processor: QueueProcessor): void {\n    this.queueSystem.registerProcessor(queueName, processor);\n  }\n\n  /**\n   * Get overall system health\n   */\n  getSystemHealth(): {\n    isHealthy: boolean;\n    totalPendingMessages: number;\n    totalProcessingMessages: number;\n    totalFailedMessages: number;\n    deadLetterCount: number;\n    uptime: number;\n  } {\n    // Get message counts by status\n    const statusCounts = this.queueSystem.executeQuery<{ status: string; count: number }>(`\n      SELECT status, COUNT(*) as count \n      FROM queue_messages \n      GROUP BY status\n    `);\n    \n    // Get dead letter count\n    const dlqResult = this.queueSystem.executeQuerySingle<{ count: number }>(\n      'SELECT COUNT(*) as count FROM dead_letter_queue'\n    );\n    const dlqCount = dlqResult?.count || 0;\n    \n    const stats = {\n      pending: 0,\n      processing: 0,\n      failed: 0\n    };\n    \n    for (const { status, count } of statusCounts) {\n      if (status in stats) {\n        (stats as any)[status] = count;\n      }\n    }\n    \n    // System is considered healthy if there are no stuck processing messages\n    // and failed messages are under control\n    const isHealthy = stats.processing < 100 && stats.failed < 1000;\n    \n    return {\n      isHealthy,\n      totalPendingMessages: stats.pending,\n      totalProcessingMessages: stats.processing,\n      totalFailedMessages: stats.failed,\n      deadLetterCount: dlqCount,\n      uptime: process.uptime() * 1000 // Convert to milliseconds\n    };\n  }\n\n  /**\n   * Safely parse JSON with fallback\n   */\n  private safeJsonParse(jsonString: any): any {\n    if (typeof jsonString !== 'string') {\n      return jsonString;\n    }\n    \n    try {\n      return JSON.parse(jsonString);\n    } catch {\n      return jsonString; // Return as-is if parsing fails\n    }\n  }\n\n  /**\n   * Close the queue system\n   */\n  close(): void {\n    this.queueSystem.close();\n  }\n}\n\n/**\n * Factory functions for creating common queue processors\n */\nexport class QueueProcessorFactory {\n  /**\n   * Create a hook event processor\n   */\n  static createHookEventProcessor(): HookEventProcessor {\n    return new HookEventProcessor();\n  }\n\n  /**\n   * Create an MCP operation processor\n   */\n  static createMCPProcessor(): MCPOperationProcessor {\n    return new MCPOperationProcessor();\n  }\n\n  /**\n   * Create a memory operation processor\n   */\n  static createMemoryProcessor(): MemoryOperationProcessor {\n    return new MemoryOperationProcessor();\n  }\n\n  /**\n   * Create a pattern detection processor\n   */\n  static createPatternProcessor(): PatternDetectionProcessor {\n    return new PatternDetectionProcessor();\n  }\n}\n\n/**\n * Hook event processor implementation\n */\nclass HookEventProcessor extends QueueProcessor {\n  constructor() {\n    super('hook-events', {\n      batchSize: 5,\n      processingTimeout: 15000,\n      cleanupInterval: 2000\n    });\n  }\n\n  protected async processMessage(message: QueueMessage): Promise<void> {\n    this.logger.info('HookEventProcessor', 'Processing hook event', {\n      messageId: message.id,\n      messageType: message.message_type,\n      correlationId: message.correlation_id\n    });\n\n    // Process the hook event based on its type\n    switch (message.message_type) {\n      case 'tool-use':\n        await this.processToolUseEvent(message.payload);\n        break;\n      case 'user-prompt':\n        await this.processUserPromptEvent(message.payload);\n        break;\n      case 'claude-response':\n        await this.processClaudeResponseEvent(message.payload);\n        break;\n      default:\n        this.logger.warn('HookEventProcessor', 'Unknown event type', {\n          messageType: message.message_type\n        });\n    }\n  }\n\n  private async processToolUseEvent(payload: any): Promise<void> {\n    // Import here to avoid circular dependencies\n    const { MemoryService } = await import('./memory');\n    const memoryService = MemoryService.getInstance();\n    \n    memoryService.storeToolUse(\n      payload.toolName,\n      payload.toolInput,\n      payload.context || {}\n    );\n  }\n\n  private async processUserPromptEvent(payload: any): Promise<void> {\n    // Import here to avoid circular dependencies\n    const { PreferenceExtractor } = await import('./preference-extractor');\n    const { MemoryService } = await import('./memory');\n    \n    const preferenceExtractor = new PreferenceExtractor();\n    const memoryService = MemoryService.getInstance();\n    \n    // Extract preferences from user prompt (handle both 'content' and 'prompt' fields)\n    const promptContent = payload.content || payload.prompt;\n    if (!promptContent) {\n      this.logger.warn('HookEventProcessor', 'No prompt content found in payload', payload);\n      return;\n    }\n    \n    const preferences = preferenceExtractor.extractPreferences(promptContent);\n    \n    // Store each extracted preference\n    for (const preference of preferences) {\n      if (preference.confidence >= 0.6) { // Only store high-confidence preferences\n        await memoryService.store({\n          key: preference.key,\n          value: JSON.stringify({\n            value: preference.value,\n            raw: preference.raw,\n            confidence: preference.confidence,\n            isOverride: preference.isOverride,\n            overrideSignals: preference.overrideSignals,\n            source: 'automatic-extraction'\n          }),\n          type: 'preference',\n          context: {\n            timestamp: Date.now(),\n            type: 'preference-extraction',\n            tool: 'PreferenceExtractor'\n          }\n        });\n        \n        this.logger.info('HookEventProcessor', 'Preference extracted and stored', {\n          key: preference.key,\n          value: preference.value,\n          confidence: preference.confidence,\n          isOverride: preference.isOverride\n        });\n      }\n    }\n    \n    // Also run legacy pattern detection as fallback\n    const { PatternService } = await import('./pattern-service');\n    const patternService = PatternService.getInstance();\n    const patterns = patternService.analyzePrompt(promptContent);\n    \n    if (patterns) {\n      memoryService.store({\n        key: `pattern-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n        value: patterns,\n        type: 'detected-pattern',\n        context: payload.context || {}\n      });\n    }\n  }\n\n  private async processClaudeResponseEvent(payload: any): Promise<void> {\n    // Process Claude's response for pattern detection and learning\n    const { PatternService } = await import('./pattern-service');\n    const patternService = PatternService.getInstance();\n    \n    // Analyze the response for patterns\n    const patterns = patternService.analyzePrompt(payload.content);\n    \n    // Store the analyzed patterns if they exist\n    if (patterns) {\n      const { MemoryService } = await import('./memory');\n      const memoryService = MemoryService.getInstance();\n      \n      memoryService.store({\n        key: `response-pattern-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n        value: patterns,\n        type: 'response-pattern',\n        context: payload.context || {}\n      });\n    }\n  }\n}\n\n/**\n * MCP operation processor implementation\n */\nclass MCPOperationProcessor extends QueueProcessor {\n  constructor() {\n    super('mcp-operations', {\n      batchSize: 3,\n      processingTimeout: 30000,\n      cleanupInterval: 3000\n    });\n  }\n\n  protected async processMessage(message: QueueMessage): Promise<void> {\n    this.logger.info('MCPOperationProcessor', 'Processing MCP operation', {\n      messageId: message.id,\n      messageType: message.message_type,\n      correlationId: message.correlation_id\n    });\n\n    const [toolName, operation] = message.message_type.split(':');\n    \n    // Route to appropriate MCP tool handler\n    switch (toolName) {\n      case 'memory':\n        await this.processMemoryTool(operation, message.payload);\n        break;\n      case 'search':\n        await this.processSearchTool(operation, message.payload);\n        break;\n      case 'pattern':\n        await this.processPatternTool(operation, message.payload);\n        break;\n      default:\n        this.logger.warn('MCPOperationProcessor', 'Unknown tool', { toolName });\n    }\n  }\n\n  private async processMemoryTool(operation: string, payload: any): Promise<void> {\n    const { MemoryService } = await import('./memory');\n    const memoryService = MemoryService.getInstance();\n    \n    switch (operation) {\n      case 'store':\n        memoryService.store(payload);\n        break;\n      case 'search':\n        memoryService.search(payload.query);\n        break;\n      default:\n        this.logger.warn('MCPOperationProcessor', 'Unknown memory operation', { operation });\n    }\n  }\n\n  private async processSearchTool(operation: string, payload: any): Promise<void> {\n    // Implement search tool operations\n    this.logger.info('MCPOperationProcessor', 'Processing search operation', { operation, payload });\n  }\n\n  private async processPatternTool(operation: string, payload: any): Promise<void> {\n    // Implement pattern tool operations\n    this.logger.info('MCPOperationProcessor', 'Processing pattern operation', { operation, payload });\n  }\n}\n\n/**\n * Memory operation processor implementation\n */\nclass MemoryOperationProcessor extends QueueProcessor {\n  constructor() {\n    super('memory-operations', {\n      batchSize: 10,\n      processingTimeout: 10000,\n      cleanupInterval: 1000\n    });\n  }\n\n  protected async processMessage(message: QueueMessage): Promise<void> {\n    this.logger.info('MemoryOperationProcessor', 'Processing memory operation', {\n      messageId: message.id,\n      messageType: message.message_type,\n      correlationId: message.correlation_id\n    });\n\n    const { MemoryService } = await import('./memory');\n    const memoryService = MemoryService.getInstance();\n    \n    switch (message.message_type) {\n      case 'store':\n        memoryService.store(message.payload);\n        break;\n      case 'search':\n        memoryService.search(message.payload.query);\n        break;\n      case 'update':\n        // Implement update logic\n        break;\n      case 'delete':\n        // Implement delete logic\n        break;\n      default:\n        this.logger.warn('MemoryOperationProcessor', 'Unknown operation', {\n          messageType: message.message_type\n        });\n    }\n  }\n}\n\n/**\n * Pattern detection processor implementation\n */\nclass PatternDetectionProcessor extends QueueProcessor {\n  constructor() {\n    super('pattern-detection', {\n      batchSize: 5,\n      processingTimeout: 20000,\n      cleanupInterval: 3000\n    });\n  }\n\n  protected async processMessage(message: QueueMessage): Promise<void> {\n    this.logger.info('PatternDetectionProcessor', 'Processing pattern detection', {\n      messageId: message.id,\n      correlationId: message.correlation_id,\n      contentLength: message.payload.content?.length\n    });\n\n    const { PatternService } = await import('./pattern-service');\n    const patternService = PatternService.getInstance();\n    \n    // Analyze the content for patterns\n    const patterns = patternService.analyzePrompt(message.payload.content);\n    \n    // Store the analyzed patterns if they exist\n    if (patterns) {\n      const { MemoryService } = await import('./memory');\n      const memoryService = MemoryService.getInstance();\n      \n      memoryService.store({\n        key: `pattern-detection-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n        value: patterns,\n        type: 'pattern-analysis',\n        context: message.payload.context || {}\n      });\n    }\n  }\n}"],"version":3}