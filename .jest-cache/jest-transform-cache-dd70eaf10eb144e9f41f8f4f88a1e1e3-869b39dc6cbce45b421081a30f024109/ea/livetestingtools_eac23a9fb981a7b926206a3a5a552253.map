{"file":"/mnt/c/Users/ebiarao/repos/claude-recall/src/mcp/tools/live-testing-tools.ts","mappings":"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","names":[],"sources":["/mnt/c/Users/ebiarao/repos/claude-recall/src/mcp/tools/live-testing-tools.ts"],"sourcesContent":["import { LiveTestingManager } from '../../testing/live-testing-manager';\nimport { RestartContinuityManager } from '../../services/restart-continuity';\nimport { TestScenario } from '../../testing/test-orchestrator';\n\nexport interface LiveTestToolParams {\n  action: string;\n  params?: any;\n}\n\nexport class LiveTestingTools {\n  private liveTestManager: LiveTestingManager;\n  private continuityManager: RestartContinuityManager;\n  \n  constructor() {\n    this.liveTestManager = LiveTestingManager.getInstance();\n    this.continuityManager = RestartContinuityManager.getInstance();\n  }\n  \n  getToolDefinitions() {\n    return [\n      {\n        name: 'live_test_start',\n        description: 'Start a live testing session with automatic restart capability',\n        parameters: {\n          type: 'object',\n          properties: {\n            tests: {\n              type: 'array',\n              description: 'Array of test scenarios to run',\n              items: {\n                type: 'object',\n                properties: {\n                  name: { type: 'string' },\n                  params: { type: 'object' }\n                }\n              }\n            },\n            config: {\n              type: 'object',\n              description: 'Live testing configuration',\n              properties: {\n                autoRestart: { type: 'boolean' },\n                restartOnFailure: { type: 'boolean' },\n                maxRestartAttempts: { type: 'number' },\n                injectResults: { type: 'boolean' }\n              }\n            }\n          },\n          required: ['tests']\n        }\n      },\n      {\n        name: 'live_test_status',\n        description: 'Get the current status of the live testing session',\n        parameters: {\n          type: 'object',\n          properties: {}\n        }\n      },\n      {\n        name: 'live_test_stop',\n        description: 'Stop the current live testing session',\n        parameters: {\n          type: 'object',\n          properties: {}\n        }\n      },\n      {\n        name: 'continuity_status',\n        description: 'Get the current continuity state and restart information',\n        parameters: {\n          type: 'object',\n          properties: {}\n        }\n      },\n      {\n        name: 'continuity_checkpoint',\n        description: 'Add a checkpoint to the current test for restart recovery',\n        parameters: {\n          type: 'object',\n          properties: {\n            checkpoint: {\n              type: 'string',\n              description: 'Checkpoint identifier'\n            }\n          },\n          required: ['checkpoint']\n        }\n      },\n      {\n        name: 'trigger_restart',\n        description: 'Manually trigger a restart for testing purposes',\n        parameters: {\n          type: 'object',\n          properties: {\n            reason: {\n              type: 'string',\n              description: 'Reason for the restart'\n            }\n          },\n          required: ['reason']\n        }\n      }\n    ];\n  }\n  \n  async handleToolCall(toolName: string, params: any): Promise<any> {\n    switch (toolName) {\n      case 'live_test_start':\n        return await this.startLiveTest(params);\n        \n      case 'live_test_status':\n        return this.getLiveTestStatus();\n        \n      case 'live_test_stop':\n        return await this.stopLiveTest();\n        \n      case 'continuity_status':\n        return this.getContinuityStatus();\n        \n      case 'continuity_checkpoint':\n        return this.addCheckpoint(params);\n        \n      case 'trigger_restart':\n        return await this.triggerRestart(params);\n        \n      default:\n        throw new Error(`Unknown tool: ${toolName}`);\n    }\n  }\n  \n  private async startLiveTest(params: any): Promise<any> {\n    try {\n      // Update configuration if provided\n      if (params.config) {\n        this.liveTestManager.updateConfig(params.config);\n      }\n      \n      // Convert test definitions to TestScenario format\n      const tests: TestScenario[] = params.tests.map((t: any) => ({\n        name: t.name,\n        params: t.params || {},\n        sessionId: `test_${Date.now()}`\n      }));\n      \n      // Start the live testing session\n      const sessionId = await this.liveTestManager.startLiveTestSession(tests);\n      \n      return {\n        success: true,\n        sessionId,\n        message: `Live testing session started with ${tests.length} tests`,\n        tests: tests.map(t => t.name),\n        config: {\n          autoRestart: params.config?.autoRestart ?? true,\n          restartOnFailure: params.config?.restartOnFailure ?? true,\n          injectResults: params.config?.injectResults ?? true\n        }\n      };\n    } catch (error) {\n      return {\n        success: false,\n        error: (error as Error).message\n      };\n    }\n  }\n  \n  private getLiveTestStatus(): any {\n    const status = this.liveTestManager.getSessionStatus();\n    const continuityState = this.continuityManager.getCurrentState();\n    \n    return {\n      liveTest: status,\n      continuity: {\n        sessionId: continuityState?.sessionId,\n        testInProgress: continuityState?.testInProgress,\n        currentTest: continuityState?.currentTest?.name,\n        checkpoints: continuityState?.currentTest?.checkpoints?.length || 0,\n        restartCount: continuityState?.restartCount || 0\n      }\n    };\n  }\n  \n  private async stopLiveTest(): Promise<any> {\n    try {\n      await this.liveTestManager.stopLiveTestSession();\n      \n      return {\n        success: true,\n        message: 'Live testing session stopped'\n      };\n    } catch (error) {\n      return {\n        success: false,\n        error: (error as Error).message\n      };\n    }\n  }\n  \n  private getContinuityStatus(): any {\n    const state = this.continuityManager.getCurrentState();\n    \n    if (!state) {\n      return {\n        status: 'no_state',\n        message: 'No continuity state available'\n      };\n    }\n    \n    return {\n      sessionId: state.sessionId,\n      testInProgress: state.testInProgress,\n      currentTest: state.currentTest,\n      pendingActions: state.pendingActions,\n      lastActivity: new Date(state.lastActivity).toISOString(),\n      restartCount: state.restartCount,\n      isTestInProgress: this.continuityManager.isTestInProgress()\n    };\n  }\n  \n  private addCheckpoint(params: any): any {\n    try {\n      this.continuityManager.addCheckpoint(params.checkpoint);\n      \n      return {\n        success: true,\n        checkpoint: params.checkpoint,\n        message: 'Checkpoint added successfully'\n      };\n    } catch (error) {\n      return {\n        success: false,\n        error: (error as Error).message\n      };\n    }\n  }\n  \n  private async triggerRestart(params: any): Promise<any> {\n    try {\n      // This would trigger a manual restart for testing\n      // In production, this would actually restart Claude Code\n      \n      return {\n        success: true,\n        message: 'Restart triggered',\n        reason: params.reason,\n        note: 'Manual restart initiated for testing'\n      };\n    } catch (error) {\n      return {\n        success: false,\n        error: (error as Error).message\n      };\n    }\n  }\n}"],"version":3}