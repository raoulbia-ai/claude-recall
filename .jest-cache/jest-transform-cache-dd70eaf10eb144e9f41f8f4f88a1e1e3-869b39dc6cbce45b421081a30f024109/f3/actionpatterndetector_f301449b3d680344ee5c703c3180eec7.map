{"file":"/mnt/c/Users/ebiarao/repos/claude-recall/src/services/action-pattern-detector.ts","mappings":"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","names":[],"sources":["/mnt/c/Users/ebiarao/repos/claude-recall/src/services/action-pattern-detector.ts"],"sourcesContent":["import { LoggingService } from './logging';\nimport { ExtractedPreference } from './preference-extractor';\n\nexport interface DetectedAction {\n  type: 'file_creation' | 'preference_mention' | 'pattern_usage' | 'tool_preference';\n  pattern: string;\n  context: {\n    tool?: string;\n    filePath?: string;\n    directory?: string;\n    content?: string;\n    timestamp: number;\n  };\n  preference?: ExtractedPreference;\n}\n\n/**\n * ActionPatternDetector - Detects patterns in Claude Code's behavior\n * \n * Instead of analyzing user input with API calls, this service detects\n * patterns in how Claude Code acts, allowing us to learn preferences\n * from behavior rather than redundant text analysis.\n */\nexport class ActionPatternDetector {\n  private logger = LoggingService.getInstance();\n  private actionHistory: DetectedAction[] = [];\n  \n  // Pattern detection thresholds\n  private readonly PATTERN_THRESHOLD = 2; // How many times before we consider it a pattern\n  private readonly RECENT_WINDOW = 10; // Number of recent actions to consider\n  \n  constructor() {\n    this.logger.info('ActionPatternDetector', 'Initialized behavioral pattern detector');\n  }\n  \n  /**\n   * Detect patterns from tool usage\n   */\n  detectToolAction(toolName: string, toolInput: any): DetectedAction | null {\n    const timestamp = Date.now();\n    \n    // Detect file creation patterns\n    if (toolName === 'Write' || toolName === 'MultiEdit') {\n      const filePath = toolInput.file_path || toolInput.filePath;\n      if (filePath) {\n        const action = this.detectFileCreationPattern(filePath, timestamp);\n        if (action) {\n          this.recordAction(action);\n          return action;\n        }\n      }\n    }\n    \n    // Detect specific tool preferences (e.g., always using axios for HTTP)\n    if (toolName === 'Write' && toolInput.content) {\n      const toolPreference = this.detectToolPreference(toolInput.content, timestamp);\n      if (toolPreference) {\n        this.recordAction(toolPreference);\n        return toolPreference;\n      }\n    }\n    \n    return null;\n  }\n  \n  /**\n   * Detect patterns from Claude's response content\n   */\n  detectResponsePattern(responseContent: string): DetectedAction | null {\n    const timestamp = Date.now();\n    \n    // Detect when Claude mentions preferences\n    const preferenceMentions = [\n      /I'll use (\\w+) for (\\w+)/gi,\n      /I'm using (\\w+) instead of (\\w+)/gi,\n      /I'll save (?:the )?(\\w+) in ([\\w\\-\\/]+)/gi,\n      /I'll create (?:the )?(\\w+) in ([\\w\\-\\/]+)/gi,\n      /Using (\\w+) as (?:the )?(\\w+)/gi\n    ];\n    \n    for (const pattern of preferenceMentions) {\n      const match = pattern.exec(responseContent);\n      if (match) {\n        const action: DetectedAction = {\n          type: 'preference_mention',\n          pattern: match[0],\n          context: {\n            content: responseContent.substring(Math.max(0, match.index - 50), match.index + match[0].length + 50),\n            timestamp\n          },\n          preference: {\n            key: this.inferPreferenceKey(match[2] || 'tool'),\n            value: match[1],\n            confidence: 0.8,\n            raw: match[0],\n            isOverride: false,\n            overrideSignals: []\n          }\n        };\n        \n        this.recordAction(action);\n        return action;\n      }\n    }\n    \n    return null;\n  }\n  \n  /**\n   * Get learned patterns based on repeated behavior\n   */\n  getLearnedPatterns(): ExtractedPreference[] {\n    const preferences: ExtractedPreference[] = [];\n    const recentActions = this.actionHistory.slice(-this.RECENT_WINDOW);\n    \n    // Group actions by type and pattern\n    const patternGroups = new Map<string, DetectedAction[]>();\n    \n    for (const action of recentActions) {\n      if (action.preference) {\n        const key = `${action.preference.key}:${action.preference.value}`;\n        if (!patternGroups.has(key)) {\n          patternGroups.set(key, []);\n        }\n        patternGroups.get(key)!.push(action);\n      }\n    }\n    \n    // Convert repeated patterns to preferences\n    for (const [key, actions] of patternGroups) {\n      if (actions.length >= this.PATTERN_THRESHOLD) {\n        const latestAction = actions[actions.length - 1];\n        if (latestAction.preference) {\n          preferences.push({\n            ...latestAction.preference,\n            confidence: Math.min(0.9, 0.5 + (actions.length * 0.1)), // Increase confidence with repetition\n            raw: `Behavioral pattern: ${latestAction.preference.raw} (observed ${actions.length} times)`\n          });\n        }\n      }\n    }\n    \n    return preferences;\n  }\n  \n  private detectFileCreationPattern(filePath: string, timestamp: number): DetectedAction | null {\n    const pathParts = filePath.split('/');\n    \n    // Detect test file patterns\n    if (filePath.includes('test') || filePath.includes('spec')) {\n      const testDir = this.findTestDirectory(pathParts);\n      if (testDir) {\n        return {\n          type: 'file_creation',\n          pattern: `test_files_in_${testDir}`,\n          context: { filePath, directory: testDir, timestamp },\n          preference: {\n            key: 'test_location',\n            value: testDir,\n            confidence: 0.85,\n            raw: `Tests created in ${testDir}`,\n            isOverride: false,\n            overrideSignals: []\n          }\n        };\n      }\n    }\n    \n    // Detect config file patterns\n    if (pathParts.includes('configs') || pathParts.includes('config')) {\n      const configDir = pathParts.includes('configs') ? 'configs' : 'config';\n      return {\n        type: 'file_creation',\n        pattern: `config_files_in_${configDir}`,\n        context: { filePath, directory: configDir, timestamp },\n        preference: {\n          key: 'config_location',\n          value: configDir,\n          confidence: 0.8,\n          raw: `Config files saved in ${configDir}`,\n          isOverride: false,\n          overrideSignals: []\n        }\n      };\n    }\n    \n    return null;\n  }\n  \n  private detectToolPreference(content: string, timestamp: number): DetectedAction | null {\n    // Detect HTTP client preferences\n    if (content.includes('axios') && (content.includes('http') || content.includes('request'))) {\n      return {\n        type: 'tool_preference',\n        pattern: 'axios_for_http',\n        context: { content: content.substring(0, 200), timestamp },\n        preference: {\n          key: 'http_client',\n          value: 'axios',\n          confidence: 0.75,\n          raw: 'Using axios for HTTP requests',\n          isOverride: false,\n          overrideSignals: []\n        }\n      };\n    }\n    \n    // Detect indentation preferences\n    if (content.includes('\\t')) {\n      return {\n        type: 'pattern_usage',\n        pattern: 'tabs_indentation',\n        context: { content: 'File uses tab indentation', timestamp },\n        preference: {\n          key: 'indentation',\n          value: 'tabs',\n          confidence: 0.7,\n          raw: 'Using tabs for indentation',\n          isOverride: false,\n          overrideSignals: []\n        }\n      };\n    } else if (content.match(/^  /m)) {\n      return {\n        type: 'pattern_usage',\n        pattern: '2_space_indentation',\n        context: { content: 'File uses 2-space indentation', timestamp },\n        preference: {\n          key: 'indentation',\n          value: '2_spaces',\n          confidence: 0.7,\n          raw: 'Using 2 spaces for indentation',\n          isOverride: false,\n          overrideSignals: []\n        }\n      };\n    }\n    \n    return null;\n  }\n  \n  private findTestDirectory(pathParts: string[]): string | null {\n    // Look for test-related directories\n    for (let i = 0; i < pathParts.length; i++) {\n      const part = pathParts[i];\n      if (part.includes('test') || part.includes('spec')) {\n        // Check if it's a custom test directory\n        if (part.startsWith('tests-') || part.startsWith('test-')) {\n          return part;\n        }\n        // Otherwise return the standard test directory\n        return part;\n      }\n    }\n    return null;\n  }\n  \n  private inferPreferenceKey(context: string): string {\n    const normalized = context.toLowerCase();\n    \n    if (normalized.includes('indent')) return 'indentation';\n    if (normalized.includes('http') || normalized.includes('request')) return 'http_client';\n    if (normalized.includes('test')) return 'test_framework';\n    if (normalized.includes('build')) return 'build_tool';\n    if (normalized.includes('ui') || normalized.includes('frontend')) return 'ui_framework';\n    if (normalized.includes('database') || normalized.includes('db')) return 'database';\n    \n    return context.toLowerCase().replace(/\\s+/g, '_');\n  }\n  \n  private recordAction(action: DetectedAction): void {\n    this.actionHistory.push(action);\n    \n    // Keep history size manageable\n    if (this.actionHistory.length > 100) {\n      this.actionHistory = this.actionHistory.slice(-50);\n    }\n    \n    this.logger.debug('ActionPatternDetector', 'Recorded action', {\n      type: action.type,\n      pattern: action.pattern,\n      preference: action.preference\n    });\n  }\n}"],"version":3}