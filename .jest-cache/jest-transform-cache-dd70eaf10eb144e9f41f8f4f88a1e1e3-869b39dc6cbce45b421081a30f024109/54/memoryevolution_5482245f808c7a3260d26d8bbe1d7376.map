{"file":"/mnt/c/Users/ebiarao/repos/claude-recall/src/services/memory-evolution.ts","mappings":";;;AACA,qCAAyC;AACzC,uCAA2C;AAE3C;;;GAGG;AACH,IAAY,mBAKX;AALD,WAAY,mBAAmB;IAC7B,yEAAc,CAAA;IACd,iFAAkB,CAAA;IAClB,qEAAY,CAAA;IACZ,+EAAiB,CAAA,CAAI,8CAA8C;AACrE,CAAC,EALW,mBAAmB,mCAAnB,mBAAmB,QAK9B;AAYD;;;;;;;;;;GAUG;AACH,MAAa,eAAe;IAI1B;QACE,IAAI,CAAC,MAAM,GAAG,wBAAc,CAAC,WAAW,EAAE,CAAC;IAC7C,CAAC;IAED,MAAM,CAAC,WAAW;QAChB,IAAI,CAAC,eAAe,CAAC,QAAQ,EAAE,CAAC;YAC9B,eAAe,CAAC,QAAQ,GAAG,IAAI,eAAe,EAAE,CAAC;QACnD,CAAC;QACD,OAAO,eAAe,CAAC,QAAQ,CAAC;IAClC,CAAC;IAED;;;OAGG;IACH,sBAAsB,CAAC,MAAc;QACnC,mCAAmC;QACnC,IAAI,MAAM,CAAC,IAAI,KAAK,UAAU,EAAE,CAAC;YAC/B,OAAO,mBAAmB,CAAC,UAAU,CAAC;QACxC,CAAC;QAED,mCAAmC;QACnC,IAAI,MAAM,CAAC,IAAI,KAAK,aAAa,EAAE,CAAC;YAClC,OAAO,mBAAmB,CAAC,cAAc,CAAC;QAC5C,CAAC;QAED,yDAAyD;QACzD,IAAI,MAAM,CAAC,IAAI,KAAK,SAAS,EAAE,CAAC;YAC9B,OAAO,mBAAmB,CAAC,cAAc,CAAC;QAC5C,CAAC;QAED,qCAAqC;QACrC,IAAI,MAAM,CAAC,IAAI,KAAK,QAAQ,EAAE,CAAC;YAC7B,OAAO,IAAI,CAAC,4BAA4B,CAAC,MAAM,CAAC,CAAC;QACnD,CAAC;QAED,+DAA+D;QAC/D,IAAI,MAAM,CAAC,IAAI,KAAK,YAAY,EAAE,CAAC;YACjC,OAAO,IAAI,CAAC,gCAAgC,CAAC,MAAM,CAAC,CAAC;QACvD,CAAC;QAED,yCAAyC;QACzC,IAAI,MAAM,CAAC,IAAI,KAAK,SAAS,EAAE,CAAC;YAC9B,OAAO,mBAAmB,CAAC,UAAU,CAAC;QACxC,CAAC;QAED,wBAAwB;QACxB,OAAO,mBAAmB,CAAC,UAAU,CAAC;IACxC,CAAC;IAED;;OAEG;IACK,4BAA4B,CAAC,MAAc;QACjD,IAAI,CAAC;YACH,MAAM,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC;YAC3B,MAAM,OAAO,GAAG,OAAO,KAAK,KAAK,QAAQ,IAAI,KAAK,CAAC,OAAO;gBACxD,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,OAAO,CAAC;gBAC/B,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;YAE1B,MAAM,KAAK,GAAG,OAAO,CAAC,WAAW,EAAE,CAAC;YAEpC,gEAAgE;YAChE,MAAM,uBAAuB,GAAG;gBAC9B,KAAK,EAAE,QAAQ,EAAE,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,QAAQ,EAAE,OAAO;gBAC3D,QAAQ,EAAE,OAAO,EAAE,QAAQ,EAAE,UAAU,EAAE,IAAI,EAAE,MAAM;aACtD,CAAC;YAEF,MAAM,OAAO,GAAG,uBAAuB,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE,CACnD,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC,CACpB,CAAC,MAAM,CAAC;YAET,0CAA0C;YAC1C,IAAI,OAAO,IAAI,CAAC,EAAE,CAAC;gBACjB,OAAO,mBAAmB,CAAC,aAAa,CAAC;YAC3C,CAAC;YAED,0CAA0C;YAC1C,OAAO,mBAAmB,CAAC,QAAQ,CAAC;QACtC,CAAC;QAAC,OAAO,GAAG,EAAE,CAAC;YACb,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,iBAAiB,EAAE,yCAAyC,EAAE,GAAG,CAAC,CAAC;YACrF,OAAO,mBAAmB,CAAC,QAAQ,CAAC;QACtC,CAAC;IACH,CAAC;IAED;;OAEG;IACK,gCAAgC,CAAC,MAAc;QACrD,IAAI,CAAC;YACH,MAAM,KAAK,GAAG,OAAO,MAAM,CAAC,KAAK,KAAK,QAAQ;gBAC5C,CAAC,CAAC,MAAM,CAAC,KAAK;gBACd,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;YAEjC,MAAM,KAAK,GAAG,KAAK,CAAC,WAAW,EAAE,CAAC;YAElC,gCAAgC;YAChC,IAAI,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC;gBACnD,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,EAAE,CAAC;gBACvD,OAAO,mBAAmB,CAAC,QAAQ,CAAC;YACtC,CAAC;YAED,OAAO,mBAAmB,CAAC,UAAU,CAAC;QACxC,CAAC;QAAC,OAAO,GAAG,EAAE,CAAC;YACb,OAAO,mBAAmB,CAAC,UAAU,CAAC;QACxC,CAAC;IACH,CAAC;IAED;;OAEG;IACH,mBAAmB,CAAC,SAAkB,EAAE,OAAe,EAAE;QACvD,MAAM,MAAM,GAAG,IAAI,CAAC,GAAG,EAAE,GAAG,CAAC,IAAI,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC,CAAC;QAEzD,oFAAoF;QACpF,MAAM,aAAa,GAAG,sBAAa,CAAC,WAAW,EAAE,CAAC;QAClD,MAAM,WAAW,GAAG,aAAa,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;QAC7C,MAAM,QAAQ,GAAG,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE;YACtC,MAAM,SAAS,GAAG,CAAC,CAAC,SAAS,IAAI,CAAC,CAAC;YACnC,MAAM,WAAW,GAAG,SAAS,GAAG,MAAM,CAAC;YACvC,MAAM,cAAc,GAAG,CAAC,SAAS,IAAI,CAAC,CAAC,UAAU,KAAK,SAAS,CAAC;YAChE,OAAO,WAAW,IAAI,cAAc,CAAC;QACvC,CAAC,CAAC,CAAC;QAEH,IAAI,QAAQ,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;YAC1B,OAAO,IAAI,CAAC,eAAe,EAAE,CAAC;QAChC,CAAC;QAED,qCAAqC;QACrC,MAAM,SAAS,GAA2B;YACxC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;SACvB,CAAC;QAEF,IAAI,eAAe,GAAG,CAAC,CAAC;QACxB,IAAI,eAAe,GAAG,CAAC,CAAC;QACxB,IAAI,YAAY,GAAG,CAAC,CAAC;QAErB,KAAK,MAAM,GAAG,IAAI,QAAQ,EAAE,CAAC;YAC3B,MAAM,KAAK,GAAG,GAAG,CAAC,oBAAoB,IAAI,CAAC,CAAC;YAC5C,SAAS,CAAC,KAAK,CAAC,EAAE,CAAC;YAEnB,IAAI,GAAG,CAAC,gBAAgB,EAAE,CAAC;gBACzB,eAAe,IAAI,GAAG,CAAC,gBAAgB,CAAC;gBACxC,eAAe,EAAE,CAAC;YACpB,CAAC;YAED,IAAI,GAAG,CAAC,IAAI,KAAK,SAAS,EAAE,CAAC;gBAC3B,YAAY,EAAE,CAAC;YACjB,CAAC;QACH,CAAC;QAED,+BAA+B;QAC/B,MAAM,aAAa,GAAG,eAAe,GAAG,CAAC;YACvC,CAAC,CAAC,eAAe,GAAG,eAAe;YACnC,CAAC,CAAC,CAAC,CAAC;QAEN,yBAAyB;QACzB,MAAM,WAAW,GAAG,QAAQ,CAAC,MAAM,GAAG,CAAC;YACrC,CAAC,CAAC,CAAC,YAAY,GAAG,QAAQ,CAAC,MAAM,CAAC,GAAG,GAAG;YACxC,CAAC,CAAC,CAAC,CAAC;QAEN,gDAAgD;QAChD,MAAM,UAAU,GAAG,MAAM,GAAG,CAAC,IAAI,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC,CAAC;QACzD,MAAM,YAAY,GAAG,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE;YAC1C,MAAM,SAAS,GAAG,CAAC,CAAC,SAAS,IAAI,CAAC,CAAC;YACnC,MAAM,WAAW,GAAG,SAAS,GAAG,UAAU,IAAI,SAAS,IAAI,MAAM,CAAC;YAClE,MAAM,cAAc,GAAG,CAAC,SAAS,IAAI,CAAC,CAAC,UAAU,KAAK,SAAS,CAAC;YAChE,OAAO,WAAW,IAAI,cAAc,CAAC;QACvC,CAAC,CAAC,CAAC;QAEH,MAAM,iBAAiB,GAAG,IAAI,CAAC,sBAAsB,CAAC,YAAY,CAAC,CAAC;QACpE,MAAM,eAAe,GAAG,IAAI,CAAC,oBAAoB,CAAC,YAAY,CAAC,CAAC;QAEhE,MAAM,eAAe,GAAG,aAAa,GAAG,iBAAiB,GAAG,IAAI,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC;YACxD,aAAa,GAAG,iBAAiB,GAAG,IAAI,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,QAAQ,CAAC;QAE1F,MAAM,YAAY,GAAG,WAAW,GAAG,eAAe,GAAG,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC;YACjD,WAAW,GAAG,eAAe,GAAG,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,QAAQ,CAAC;QAEhF,sCAAsC;QACtC,MAAM,KAAK,GAAG,QAAQ,CAAC,MAAM,CAAC;QAC9B,MAAM,KAAK,GAAG,SAAS,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC;QACnC,MAAM,KAAK,GAAG,SAAS,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC;QACnC,MAAM,KAAK,GAAG,SAAS,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC;QACnC,MAAM,KAAK,GAAG,SAAS,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC;QAEnC,MAAM,gBAAgB,GAAG,IAAI,CAAC,KAAK,CACjC,CAAC,KAAK,GAAG,EAAE,CAAC,GAAG,CAAC,KAAK,GAAG,EAAE,CAAC,GAAG,CAAC,KAAK,GAAG,EAAE,CAAC,GAAG,CAAC,KAAK,GAAG,GAAG,CAAC,CAC3D,CAAC;QAEF,OAAO;YACL,aAAa,EAAE,QAAQ,CAAC,MAAM;YAC9B,uBAAuB,EAAE,SAAgD;YACzE,iBAAiB,EAAE,aAAa;YAChC,eAAe;YACf,WAAW;YACX,YAAY;YACZ,gBAAgB;SACjB,CAAC;IACJ,CAAC;IAED;;OAEG;IACK,sBAAsB,CAAC,QAAe;QAC5C,IAAI,QAAQ,CAAC,MAAM,KAAK,CAAC;YAAE,OAAO,CAAC,CAAC;QAEpC,IAAI,KAAK,GAAG,CAAC,CAAC;QACd,IAAI,KAAK,GAAG,CAAC,CAAC;QAEd,KAAK,MAAM,GAAG,IAAI,QAAQ,EAAE,CAAC;YAC3B,IAAI,GAAG,CAAC,gBAAgB,EAAE,CAAC;gBACzB,KAAK,IAAI,GAAG,CAAC,gBAAgB,CAAC;gBAC9B,KAAK,EAAE,CAAC;YACV,CAAC;QACH,CAAC;QAED,OAAO,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;IACvC,CAAC;IAED;;OAEG;IACK,oBAAoB,CAAC,QAAe;QAC1C,IAAI,QAAQ,CAAC,MAAM,KAAK,CAAC;YAAE,OAAO,CAAC,CAAC;QAEpC,MAAM,QAAQ,GAAG,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,KAAK,SAAS,CAAC,CAAC,MAAM,CAAC;QACnE,OAAO,CAAC,QAAQ,GAAG,QAAQ,CAAC,MAAM,CAAC,GAAG,GAAG,CAAC;IAC5C,CAAC;IAED;;OAEG;IACK,eAAe;QACrB,OAAO;YACL,aAAa,EAAE,CAAC;YAChB,uBAAuB,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE;YACnD,iBAAiB,EAAE,CAAC;YACpB,eAAe,EAAE,QAAQ;YACzB,WAAW,EAAE,CAAC;YACd,YAAY,EAAE,QAAQ;YACtB,gBAAgB,EAAE,CAAC;SACpB,CAAC;IACJ,CAAC;IAED;;OAEG;IACH,MAAM,CAAC,qBAAqB,CAAC,KAA0B;QACrD,QAAQ,KAAK,EAAE,CAAC;YACd,KAAK,mBAAmB,CAAC,UAAU;gBACjC,OAAO,YAAY,CAAC;YACtB,KAAK,mBAAmB,CAAC,cAAc;gBACrC,OAAO,iBAAiB,CAAC;YAC3B,KAAK,mBAAmB,CAAC,QAAQ;gBAC/B,OAAO,UAAU,CAAC;YACpB,KAAK,mBAAmB,CAAC,aAAa;gBACpC,OAAO,eAAe,CAAC;YACzB;gBACE,OAAO,SAAS,CAAC;QACrB,CAAC;IACH,CAAC;CACF;AA1QD,0CA0QC","names":[],"sources":["/mnt/c/Users/ebiarao/repos/claude-recall/src/services/memory-evolution.ts"],"sourcesContent":["import { Memory } from '../memory/storage';\nimport { MemoryService } from './memory';\nimport { LoggingService } from './logging';\n\n/**\n * Sophistication Levels (v0.7.0)\n * Based on ReasoningBank's emergent behavior progression\n */\nexport enum SophisticationLevel {\n  Procedural = 1,      // Basic execution (tool-use, simple actions)\n  SelfReflection = 2,  // Error checking, corrections\n  Adaptive = 3,        // Systematic patterns (devops single category)\n  Compositional = 4    // Multi-constraint reasoning (devops complex)\n}\n\nexport interface EvolutionMetrics {\n  totalMemories: number;\n  sophisticationBreakdown: Record<SophisticationLevel, number>;\n  averageConfidence: number;\n  confidenceTrend: 'improving' | 'stable' | 'declining';\n  failureRate: number;\n  failureTrend: 'improving' | 'stable' | 'worsening';\n  progressionScore: number;  // 0-100 (higher = more evolved)\n}\n\n/**\n * MemoryEvolution Service (v0.7.0)\n *\n * Tracks agent evolution through sophistication levels:\n * - L1 Procedural: Basic tool use\n * - L2 Self-Reflection: Error checking, corrections\n * - L3 Adaptive: Systematic workflows\n * - L4 Compositional: Multi-constraint reasoning\n *\n * Provides metrics showing agent getting smarter over time\n */\nexport class MemoryEvolution {\n  private static instance: MemoryEvolution;\n  private logger: LoggingService;\n\n  private constructor() {\n    this.logger = LoggingService.getInstance();\n  }\n\n  static getInstance(): MemoryEvolution {\n    if (!MemoryEvolution.instance) {\n      MemoryEvolution.instance = new MemoryEvolution();\n    }\n    return MemoryEvolution.instance;\n  }\n\n  /**\n   * Classify memory sophistication level\n   * Called when storing new memory\n   */\n  classifySophistication(memory: Memory): SophisticationLevel {\n    // Tool-use memories are procedural\n    if (memory.type === 'tool-use') {\n      return SophisticationLevel.Procedural;\n    }\n\n    // Corrections show self-reflection\n    if (memory.type === 'corrections') {\n      return SophisticationLevel.SelfReflection;\n    }\n\n    // Failures show self-reflection (learning from mistakes)\n    if (memory.type === 'failure') {\n      return SophisticationLevel.SelfReflection;\n    }\n\n    // DevOps memories vary by complexity\n    if (memory.type === 'devops') {\n      return this.classifyDevOpsSophistication(memory);\n    }\n\n    // Preferences can be adaptive if they show systematic thinking\n    if (memory.type === 'preference') {\n      return this.classifyPreferenceSophistication(memory);\n    }\n\n    // Success memories default to procedural\n    if (memory.type === 'success') {\n      return SophisticationLevel.Procedural;\n    }\n\n    // Default to procedural\n    return SophisticationLevel.Procedural;\n  }\n\n  /**\n   * Classify DevOps memory sophistication\n   */\n  private classifyDevOpsSophistication(memory: Memory): SophisticationLevel {\n    try {\n      const value = memory.value;\n      const content = typeof value === 'object' && value.content\n        ? JSON.stringify(value.content)\n        : JSON.stringify(value);\n\n      const lower = content.toLowerCase();\n\n      // Check for compositional patterns (multi-constraint reasoning)\n      const compositionalIndicators = [\n        'and', 'before', 'after', 'then', 'must', 'always', 'never',\n        'verify', 'check', 'ensure', 'validate', 'if', 'when'\n      ];\n\n      const matches = compositionalIndicators.filter(ind =>\n        lower.includes(ind)\n      ).length;\n\n      // 3+ indicators = compositional reasoning\n      if (matches >= 3) {\n        return SophisticationLevel.Compositional;\n      }\n\n      // Otherwise adaptive (systematic pattern)\n      return SophisticationLevel.Adaptive;\n    } catch (err) {\n      this.logger.debug('MemoryEvolution', 'Error classifying devops sophistication', err);\n      return SophisticationLevel.Adaptive;\n    }\n  }\n\n  /**\n   * Classify preference sophistication\n   */\n  private classifyPreferenceSophistication(memory: Memory): SophisticationLevel {\n    try {\n      const value = typeof memory.value === 'string'\n        ? memory.value\n        : JSON.stringify(memory.value);\n\n      const lower = value.toLowerCase();\n\n      // Check for systematic thinking\n      if (lower.includes('always') || lower.includes('never') ||\n          lower.includes('must') || lower.includes('should')) {\n        return SophisticationLevel.Adaptive;\n      }\n\n      return SophisticationLevel.Procedural;\n    } catch (err) {\n      return SophisticationLevel.Procedural;\n    }\n  }\n\n  /**\n   * Calculate evolution metrics for project or globally\n   */\n  getEvolutionMetrics(projectId?: string, days: number = 30): EvolutionMetrics {\n    const cutoff = Date.now() - (days * 24 * 60 * 60 * 1000);\n\n    // Search for recent memories (lazy-load MemoryService to avoid circular dependency)\n    const memoryService = MemoryService.getInstance();\n    const allMemories = memoryService.search('');\n    const memories = allMemories.filter(m => {\n      const timestamp = m.timestamp || 0;\n      const matchesTime = timestamp > cutoff;\n      const matchesProject = !projectId || m.project_id === projectId;\n      return matchesTime && matchesProject;\n    });\n\n    if (memories.length === 0) {\n      return this.getEmptyMetrics();\n    }\n\n    // Calculate sophistication breakdown\n    const breakdown: Record<number, number> = {\n      1: 0, 2: 0, 3: 0, 4: 0\n    };\n\n    let totalConfidence = 0;\n    let confidenceCount = 0;\n    let failureCount = 0;\n\n    for (const mem of memories) {\n      const level = mem.sophistication_level || 1;\n      breakdown[level]++;\n\n      if (mem.confidence_score) {\n        totalConfidence += mem.confidence_score;\n        confidenceCount++;\n      }\n\n      if (mem.type === 'failure') {\n        failureCount++;\n      }\n    }\n\n    // Calculate average confidence\n    const avgConfidence = confidenceCount > 0\n      ? totalConfidence / confidenceCount\n      : 0;\n\n    // Calculate failure rate\n    const failureRate = memories.length > 0\n      ? (failureCount / memories.length) * 100\n      : 0;\n\n    // Calculate trends (compare to previous period)\n    const prevCutoff = cutoff - (days * 24 * 60 * 60 * 1000);\n    const prevMemories = allMemories.filter(m => {\n      const timestamp = m.timestamp || 0;\n      const matchesTime = timestamp > prevCutoff && timestamp <= cutoff;\n      const matchesProject = !projectId || m.project_id === projectId;\n      return matchesTime && matchesProject;\n    });\n\n    const prevAvgConfidence = this.calculateAvgConfidence(prevMemories);\n    const prevFailureRate = this.calculateFailureRate(prevMemories);\n\n    const confidenceTrend = avgConfidence > prevAvgConfidence + 0.05 ? 'improving' :\n                            avgConfidence < prevAvgConfidence - 0.05 ? 'declining' : 'stable';\n\n    const failureTrend = failureRate < prevFailureRate - 2 ? 'improving' :\n                         failureRate > prevFailureRate + 2 ? 'worsening' : 'stable';\n\n    // Calculate progression score (0-100)\n    const total = memories.length;\n    const l1Pct = breakdown[1] / total;\n    const l2Pct = breakdown[2] / total;\n    const l3Pct = breakdown[3] / total;\n    const l4Pct = breakdown[4] / total;\n\n    const progressionScore = Math.round(\n      (l1Pct * 25) + (l2Pct * 50) + (l3Pct * 75) + (l4Pct * 100)\n    );\n\n    return {\n      totalMemories: memories.length,\n      sophisticationBreakdown: breakdown as Record<SophisticationLevel, number>,\n      averageConfidence: avgConfidence,\n      confidenceTrend,\n      failureRate,\n      failureTrend,\n      progressionScore\n    };\n  }\n\n  /**\n   * Calculate average confidence from memory list\n   */\n  private calculateAvgConfidence(memories: any[]): number {\n    if (memories.length === 0) return 0;\n\n    let total = 0;\n    let count = 0;\n\n    for (const mem of memories) {\n      if (mem.confidence_score) {\n        total += mem.confidence_score;\n        count++;\n      }\n    }\n\n    return count > 0 ? total / count : 0;\n  }\n\n  /**\n   * Calculate failure rate from memory list\n   */\n  private calculateFailureRate(memories: any[]): number {\n    if (memories.length === 0) return 0;\n\n    const failures = memories.filter(m => m.type === 'failure').length;\n    return (failures / memories.length) * 100;\n  }\n\n  /**\n   * Return empty metrics when no memories exist\n   */\n  private getEmptyMetrics(): EvolutionMetrics {\n    return {\n      totalMemories: 0,\n      sophisticationBreakdown: { 1: 0, 2: 0, 3: 0, 4: 0 },\n      averageConfidence: 0,\n      confidenceTrend: 'stable',\n      failureRate: 0,\n      failureTrend: 'stable',\n      progressionScore: 0\n    };\n  }\n\n  /**\n   * Get sophistication level name\n   */\n  static getSophisticationName(level: SophisticationLevel): string {\n    switch (level) {\n      case SophisticationLevel.Procedural:\n        return 'Procedural';\n      case SophisticationLevel.SelfReflection:\n        return 'Self-Reflection';\n      case SophisticationLevel.Adaptive:\n        return 'Adaptive';\n      case SophisticationLevel.Compositional:\n        return 'Compositional';\n      default:\n        return 'Unknown';\n    }\n  }\n}\n"],"version":3}