{"file":"/mnt/c/Users/ebiarao/repos/claude-recall/src/services/keyword-extractor.ts","mappings":"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","names":[],"sources":["/mnt/c/Users/ebiarao/repos/claude-recall/src/services/keyword-extractor.ts"],"sourcesContent":["/**\n * Keyword Extractor Service\n * Phase 3B: Extract keywords from tool inputs for proactive memory search\n *\n * This service:\n * 1. Extracts meaningful keywords from tool call arguments\n * 2. Filters out stop words and noise\n * 3. Identifies technical terms and domain-specific keywords\n * 4. Provides ranked keywords for memory search\n */\n\nimport { LoggingService } from './logging';\n\nexport interface ExtractedKeywords {\n  keywords: string[];\n  technicalTerms: string[];\n  allTokens: string[];\n}\n\nexport class KeywordExtractor {\n  private static instance: KeywordExtractor;\n  private logger: LoggingService;\n\n  // Common stop words to filter out\n  private readonly STOP_WORDS = new Set([\n    'the', 'a', 'an', 'and', 'or', 'but', 'in', 'on', 'at', 'to', 'for',\n    'of', 'with', 'by', 'from', 'as', 'is', 'was', 'are', 'were', 'be',\n    'been', 'being', 'have', 'has', 'had', 'do', 'does', 'did', 'will',\n    'would', 'should', 'could', 'may', 'might', 'must', 'can', 'this',\n    'that', 'these', 'those', 'i', 'you', 'he', 'she', 'it', 'we', 'they',\n    'what', 'which', 'who', 'when', 'where', 'why', 'how', 'all', 'each',\n    'every', 'both', 'few', 'more', 'most', 'other', 'some', 'such', 'no',\n    'nor', 'not', 'only', 'own', 'same', 'so', 'than', 'too', 'very', 'just'\n  ]);\n\n  // Technical/programming keywords that are always relevant\n  private readonly TECHNICAL_KEYWORDS = new Set([\n    // Languages\n    'javascript', 'typescript', 'python', 'java', 'go', 'rust', 'ruby', 'php',\n    'c', 'cpp', 'csharp', 'swift', 'kotlin', 'scala',\n    // Frameworks\n    'react', 'vue', 'angular', 'svelte', 'next', 'nuxt', 'express', 'fastify',\n    'django', 'flask', 'rails', 'spring', 'laravel',\n    // Testing\n    'test', 'tests', 'testing', 'jest', 'mocha', 'chai', 'vitest', 'cypress',\n    'playwright', 'selenium', 'spec', 'specs',\n    // Tools\n    'git', 'github', 'gitlab', 'docker', 'kubernetes', 'npm', 'yarn', 'pnpm',\n    'webpack', 'vite', 'rollup', 'babel', 'eslint', 'prettier',\n    // Databases\n    'database', 'db', 'sql', 'mysql', 'postgresql', 'postgres', 'sqlite',\n    'mongodb', 'redis', 'dynamodb',\n    // Concepts\n    'api', 'rest', 'graphql', 'http', 'https', 'endpoint', 'route', 'middleware',\n    'component', 'function', 'class', 'module', 'package', 'library',\n    'commit', 'branch', 'merge', 'pull', 'push', 'clone', 'fork'\n  ]);\n\n  private constructor() {\n    this.logger = LoggingService.getInstance();\n  }\n\n  static getInstance(): KeywordExtractor {\n    if (!KeywordExtractor.instance) {\n      KeywordExtractor.instance = new KeywordExtractor();\n    }\n    return KeywordExtractor.instance;\n  }\n\n  /**\n   * Extract keywords from tool call arguments\n   * Returns ranked keywords suitable for memory search\n   */\n  extract(toolArgs: any): ExtractedKeywords {\n    try {\n      // Extract all text from arguments\n      const text = this.extractText(toolArgs);\n\n      // Tokenize\n      const tokens = this.tokenize(text);\n\n      // Filter and categorize\n      const keywords = this.filterKeywords(tokens);\n      const technicalTerms = this.identifyTechnicalTerms(tokens);\n\n      // Combine and deduplicate\n      const allKeywords = [...new Set([...technicalTerms, ...keywords])];\n\n      this.logger.debug('KeywordExtractor', 'Extracted keywords', {\n        totalTokens: tokens.length,\n        keywords: allKeywords.length,\n        technicalTerms: technicalTerms.length\n      });\n\n      return {\n        keywords: allKeywords,\n        technicalTerms,\n        allTokens: tokens\n      };\n\n    } catch (error) {\n      this.logger.error('KeywordExtractor', 'Failed to extract keywords', error);\n      return {\n        keywords: [],\n        technicalTerms: [],\n        allTokens: []\n      };\n    }\n  }\n\n  /**\n   * Extract all text from various argument formats\n   */\n  private extractText(args: any): string {\n    if (typeof args === 'string') {\n      return args;\n    }\n\n    if (typeof args === 'object' && args !== null) {\n      const textParts: string[] = [];\n\n      // Extract from common fields\n      if (args.content) textParts.push(this.extractText(args.content));\n      if (args.text) textParts.push(this.extractText(args.text));\n      if (args.message) textParts.push(this.extractText(args.message));\n      if (args.query) textParts.push(this.extractText(args.query));\n      if (args.description) textParts.push(this.extractText(args.description));\n      if (args.name) textParts.push(this.extractText(args.name));\n      if (args.key) textParts.push(this.extractText(args.key));\n      if (args.value) textParts.push(this.extractText(args.value));\n\n      // Extract from all string values recursively\n      for (const value of Object.values(args)) {\n        if (typeof value === 'string') {\n          textParts.push(value);\n        } else if (typeof value === 'object' && value !== null) {\n          textParts.push(this.extractText(value));\n        }\n      }\n\n      return textParts.join(' ');\n    }\n\n    return '';\n  }\n\n  /**\n   * Tokenize text into words\n   */\n  private tokenize(text: string): string[] {\n    return text\n      .toLowerCase()\n      .replace(/[^\\w\\s-]/g, ' ') // Keep hyphens for compound words\n      .split(/\\s+/)\n      .filter(token => token.length > 0);\n  }\n\n  /**\n   * Filter tokens to extract meaningful keywords\n   */\n  private filterKeywords(tokens: string[]): string[] {\n    return tokens\n      .filter(token => {\n        // Remove stop words\n        if (this.STOP_WORDS.has(token)) return false;\n\n        // Keep tokens that are at least 3 characters\n        if (token.length < 3) return false;\n\n        // Keep tokens that aren't just numbers\n        if (/^\\d+$/.test(token)) return false;\n\n        return true;\n      });\n  }\n\n  /**\n   * Identify technical/programming terms\n   */\n  private identifyTechnicalTerms(tokens: string[]): string[] {\n    return tokens.filter(token => this.TECHNICAL_KEYWORDS.has(token));\n  }\n\n  /**\n   * Extract keywords optimized for memory search\n   * Returns top N most relevant keywords\n   */\n  extractForSearch(toolArgs: any, maxKeywords: number = 5): string[] {\n    const extracted = this.extract(toolArgs);\n\n    // Prioritize technical terms\n    const topKeywords = [\n      ...extracted.technicalTerms,\n      ...extracted.keywords.filter(k => !extracted.technicalTerms.includes(k))\n    ];\n\n    return topKeywords.slice(0, maxKeywords);\n  }\n\n  /**\n   * Extract keywords as a search query string\n   */\n  extractAsQuery(toolArgs: any): string {\n    const keywords = this.extractForSearch(toolArgs);\n    return keywords.join(' ');\n  }\n}\n"],"version":3}